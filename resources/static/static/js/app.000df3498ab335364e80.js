webpackJsonp([1],{0:function(e,t,a){a("briU"),e.exports=a("NHnr")},B8GT:function(e,t){},Dup8:function(e,t){},Jp6j:function(e,t){},Lku9:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("7+uW"),s=a("mtWM"),i=a.n(s),o=a("/ocq"),r=a("mvHQ"),n=a.n(r),u=function(e,t){for(var a=0;a<e.length;a++)for(var l=0;l<t.length;l++)if(e[a].editOffice==t[l].id){e[a].editOffice=t[l].name;break}return e},c=function(e,t){for(var a=0;a<e.length;a++)for(var l=0;l<t.length;l++)if(e[a].office==t[l].id){e[a].office=t[l].name;break}return e},f=function(e){de("/user/currentUser").then(function(t){if(200==t.status){var a={id:t.data.data.id,username:t.data.data.username,office:t.data.data.office,roles:t.data.data.roles};window.document.cookie="currentUser="+n()(a);var l=[],s=n()(t.data.data.roles);(s.toString().indexOf("超级管理员")>-1||s.toString().indexOf("体系管理员")>-1)&&(l.push("deletePerm"),l.push("editPerm")),window.document.cookie="permissions="+l,e.$router.replace({path:"/fileList"})}else e.$alert("登陆失败，获取不到该用户的信息!","失败!")})},m=function(e){var t;if(document.cookie.length>0)for(var a=document.cookie.split("; "),l=0;l<a.length;l++){var s=a[l].split("=");s[0]==e&&(t=s[1])}return t},d={created:function(){f(this)},mounted:function(){var e=m("currentUser");this.currentUser=JSON.parse(e);var t=this;window.bus.$on("changeIsReload",function(){t.isReload=!1})},data:function(){return{currentUser:"",dialogVisible:!1,newPassword:"",collapse:!1,isRouterAlive:!0,isReload:!1}},methods:{handleCommand:function(e){var t=this;"logout"===e&&this.$confirm("注销登录吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){de("/logout"),t.$router.push({path:"/"}),sessionStorage.clear()},function(){}),"updatePassword"===e&&(this.dialogVisible=!0)},updatePassword:function(){var e=this;ue("/user/password",{id:this.currentUser.id,password:this.newPassword}).then(function(t){200==t.status?1e3===t.data.code?(e.dialogVisible=!1,e.newPassword="",e.$alert(t.data.data+",即将重新登录！","成功",{showClose:!1}).then(function(){de("/logout"),e.$router.push({path:"/"}),sessionStorage.clear()})):e.$message({type:"error",message:t.data.data}):e.$message({type:"error",message:"提交失败"})},function(t){403==t.response.status?e.$message({type:"error",message:t.response.data}):e.$message({type:"error",message:"根本找不到服务器"})})},handleSelect:function(e,t){if("/user"===e||"/temperature"===e){for(var a=this.currentUser.roles,l=!1,s=0;s<a.length;s++)"/user"!==e||"超级管理员"!==a[s].name&&"公司领导"!==a[s].name&&"部门领导"!==a[s].name&&"科室主任"!==a[s].name||(l=!0),"/temperature"!==e||"超级管理员"!==a[s].name&&"公司领导"!==a[s].name&&"部门领导"!==a[s].name&&"科室主任"!==a[s].name&&"体温管理员"!==a[s].name&&"体温记录员"!==a[s].name||(l=!0);l?this.$router.push({path:e}):this.$alert("您还没有权限查看哦！ 权限开通请联系科室主任或管理员","权限不足",{confirmButtonText:"确定",type:"warning"})}else this.$route.path!==e?(this.$router.push({path:e}),this.isReload=!1):(this.isReload=!0,this.isRouterAlive=!1,this.$nextTick(function(){this.isRouterAlive=!0}))},collapseChage:function(){this.collapse=!this.collapse}}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{staticClass:"home_container"},[a("el-header",[a("div",{staticClass:"home_title"},[a("div",{staticClass:"collapse-btn",on:{click:e.collapseChage}},[a("i",{staticClass:"el-icon-menu"})]),e._v(" "),a("span",[e._v("部门文档管理系统")])]),e._v(" "),a("div",{staticClass:"home_userinfoContainer"},[a("el-dropdown",{on:{command:e.handleCommand}},[a("span",{staticClass:"el-dropdown-link home_userinfo"},[e._v("\n          "+e._s(e.currentUser.username)),a("i",{staticClass:"el-icon-arrow-down el-icon--right home_userinfo"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"updatePassword"}},[e._v("修改密码")]),e._v(" "),a("el-dropdown-item",{attrs:{command:"logout"}},[e._v("退出登录")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"修改密码",visible:e.dialogVisible,center:""},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-input",{attrs:{type:"password",placeholder:"请输入新密码","show-password":"",required:""},model:{value:e.newPassword,callback:function(t){e.newPassword=t},expression:"newPassword"}}),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.updatePassword}},[e._v("提交")])],1)],1)],1)]),e._v(" "),a("el-container",[a("el-aside",{attrs:{width:"auto"}},[a("el-menu",{staticClass:"el-menu-vertical-demo",staticStyle:{"background-color":"#ECECEC"},attrs:{"default-active":"0",collapse:e.collapse},on:{select:e.handleSelect}},[e._l(this.$router.options.routes,function(t,l){return t.hidden?e._e():[t.children.length>1?a("el-submenu",{key:l,attrs:{index:l+""}},[a("template",{slot:"title"},[a("i",{class:t.iconCls}),e._v(" "),a("span",[e._v(e._s(t.name))])]),e._v(" "),e._l(t.children,function(t){return t.hidden?e._e():a("el-menu-item",{key:t.path,attrs:{index:t.path}},[e._v("\n              "+e._s(t.name)+"\n            ")])})],2):[a("el-menu-item",{attrs:{index:t.children[0].path}},[a("i",{class:t.children[0].iconCls}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.children[0].name))])])]]})],2)],1),e._v(" "),a("el-container",{staticClass:"main-container"},[a("el-main",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),e._v(" "),a("el-breadcrumb-item",{domProps:{textContent:e._s(this.$router.currentRoute.name)}})],1),e._v(" "),a("keep-alive",[this.$route.meta.keepAlive?a("router-view"):e._e()],1),e._v(" "),!this.$route.meta.keepAlive&&e.isRouterAlive?a("router-view",{attrs:{isReload:e.isReload}}):e._e()],1),e._v(" "),a("el-footer",[a("p",[e._v("©控制器五室           "),a("span",[e._v("邮箱:201483 201998")])])])],1)],1)],1)},staticRenderFns:[]};var h=a("VU/8")(d,p,!1,function(e){a("blJu")},null,null).exports,v={data:function(){return{rules:{mail:[{required:!0,message:"请输入邮箱号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},checked:!0,loginForm:{mail:"",password:""},loading:!1}},mounted:function(){this.getCookie()},methods:{submitClick:function(e){var t=this,a=this;1==this.checked?this.setCookie(this.loginForm.mail,this.loginForm.password,7):this.clearCookie(),this.loading=!0,this.$refs[e].validate(function(e){e?ue("/login",{mail:t.loginForm.mail,password:t.loginForm.password}).then(function(e){a.loading=!1,200==e.status?1e3===e.data.code?(sessionStorage.setItem("isLogin",!0),f(a)):a.$alert(e.data.data,"失败!"):a.$alert("登陆失败!","失败!")},function(e){a.loading=!1,a.$alert("找不到服务器⊙﹏⊙∥!","失败!")}):(a.loading=!1,a.$alert("请输入账号密码!","失败！"))})},setCookie:function(e,t,a){var l=new Date;l.setTime(l.getTime()+864e5*a),window.document.cookie="mail="+e+";path=/;expires="+l.toGMTString(),window.document.cookie="password="+t+";path=/;expires="+l.toGMTString()},getCookie:function(){if(document.cookie.length>0)for(var e=document.cookie.split("; "),t=0;t<e.length;t++){var a=e[t].split("=");"mail"==a[0]?this.loginForm.mail=a[1]:"password"==a[0]&&(this.loginForm.password=a[1])}},clearCookie:function(){this.setCookie("","",-1)}}},g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"loginForm",staticClass:"login-container",attrs:{rules:e.rules,"label-position":"left",model:e.loginForm}},[a("h3",{staticClass:"login_title"},[e._v("部门发文系统登录")]),e._v(" "),a("el-form-item",{attrs:{prop:"mail",label:"邮箱","label-width":"50px"}},[a("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"邮箱"},model:{value:e.loginForm.mail,callback:function(t){e.$set(e.loginForm,"mail",t)},expression:"loginForm.mail"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"password",label:"密码","label-width":"50px"}},[a("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"密码"},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),e._v(" "),a("el-checkbox",{staticClass:"login_remember",attrs:{"label-position":"left"},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("记住密码")]),e._v(" "),a("el-form-item",[a("span",{attrs:{sytle:"color:#606266"}},[e._v("默认密码:123456")])]),e._v(" "),a("el-form-item",{staticStyle:{width:"100%"}},[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.submitClick("loginForm")}}},[e._v("登录")])],1)],1)},staticRenderFns:[]};var b=a("VU/8")(v,g,!1,function(e){a("Jp6j")},null,null).exports,_={data:function(){return{form:{fileNo:"",fileName:"",editOffice:"",editPerson:"",fileType:"",issueDate:"",major:"",plate:"",status:"受控"},labelPosition:"left",list:[],selItems:[],loading:!1,currentPageNum:1,totalCount:-1,pageSize:10,hasConditions:!1,deleteData:[],offices:[],currentUser:"",tab:"manage"}},beforeDestroy:function(){window.bus.$off("manage_list")},mounted:function(){this.currentUser=JSON.parse(m("currentUser")),this.loadOffices();this.loading=!0;var e={fileNo:this.form.fileNo,fileName:this.form.fileName,editOffice:this.form.editOffice,editPerson:this.form.editPerson,fileType:this.form.fileType,issueDate:this.form.issueDate,major:this.form.major,plate:this.form.plate,status:this.form.status,tab:this.tab,currentPageNum:this.currentPageNum,pageSize:this.pageSize};this.loadList(e);var t=this;window.bus.$on("manage_list",function(){t.loading=!0;var e={fileNo:t.form.fileNo,fileName:t.form.fileName,editOffice:t.form.editOffice,editPerson:t.form.editPerson,fileType:t.form.fileType,issueDate:t.form.issueDate,major:t.form.major,plate:t.form.plate,status:t.form.status,tab:t.tab,currentPageNum:t.currentPageNum,pageSize:t.pageSize};null==e.issueDate&&(e.issueDate=""),t.loadList(e)})},methods:{onSubmit:function(){this.loading=!0;var e={fileNo:this.form.fileNo,fileName:this.form.fileName,editOffice:this.form.editOffice,editPerson:this.form.editPerson,fileType:this.form.fileType,issueDate:this.form.issueDate,major:this.form.major,plate:this.form.plate,status:this.form.status,tab:this.tab,currentPageNum:this.currentPageNum,pageSize:this.pageSize};null==e.issueDate&&(e.issueDate=""),this.loadList(e)},deleteMany:function(){var e=this;this.$confirm("此操作将会删除该文件，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){for(var t=e.selItems,a=0;a<t.length;a++)e.deleteData.push(t[a].id);var l={aids:e.deleteData};e.deleteDocs(l)}).catch(function(){})},handleCurrentChange:function(e){this.currentPageNum=e,this.loading=!0;var t={fileNo:this.form.fileNo,fileName:this.form.fileName,editOffice:this.form.editOffice,editPerson:this.form.editPerson,fileType:this.form.fileType,issueDate:this.form.issueDate,major:this.form.major,plate:this.form.plate,status:this.form.status,tab:this.tab,currentPageNum:this.currentPageNum,pageSize:this.pageSize};null==t.issueDate&&(t.issueDate=""),this.loadList(t)},handleSelectionChange:function(e){this.selItems=e},handleEdit:function(e,t){this.$router.push({name:"上传文档",params:{row:t,flag:!0,changeVersion:!1,isReload:!1}})},handleDelete:function(e,t){var a=this;this.$confirm("此操作将会删除该文件，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.deleteData.length=0,a.deleteData.push(t.id);var e={aids:a.deleteData};a.deleteDocs(e)}).catch(function(){})},handleDownload:function(e,t){var a=this,l={filePath:t.filePath};fe("/anounce/download",l).then(function(e){if(200==e.status){if(0==e.data.size)return void a.$message({type:"error",message:"不存在该文档"});var t=window.URL.createObjectURL(new Blob([e.data])),s=document.createElement("a");s.style.display="none",s.href=t;var i=l.filePath,o=i.lastIndexOf("\\");s.setAttribute("download",i.substring(o,i.length)),document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(s.href),a.$message({type:"success",message:"正在下载！"})}else a.$message({type:"error",message:"下载失败"})})},loadOffices:function(){var e=this;de("/office/all",null).then(function(t){200==t.status?(e.offices=t.data.data,null!=e.list&&(e.list=u(e.list,e.offices))):e.$message({type:"error",message:"科室目录加载失败！"})},function(t){e.$message({type:"error",message:"科室目录加载失败！"})})},loadList:function(e){var t=this;ue("/anounce/all",e).then(function(e){t.loading=!1,200==e.status?(t.list=e.data.data.records,null!=t.offices&&(t.list=u(e.data.data.records,t.offices)),t.totalCount=e.data.data.totalCount):t.$message({type:"error",message:"数据加载失败！"})},function(e){t.loading=!1,403==e.response.status?t.$message({type:"error",message:e.response.data}):t.$message({type:"error",message:"数据加载失败！"})}).catch(function(e){t.loading=!1,t.$message({type:"error",message:"数据加载失败！"})})},deleteDocs:function(e){var t=this;ue("/anounce/delete",e).then(function(e){t.loading=!1,200==e.status?(1e3===e.data.code?(t.$message({type:"success",message:e.data.data}),window.bus.$emit("manage_list")):t.$message({type:"error",message:e.data.data}),t.deleteData.length=0):t.$message({type:"error",message:"删除失败！"})},function(e){t.loading=!1,403==e.response.status?t.$alert("无权限进行删除操作","权限不足",{confirmButtonText:"确定",type:"warning"}):t.$message({type:"error",message:"删除失败！"})})}}},y={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"main_div"},[a("div",{staticClass:"search_div",staticStyle:{display:"flex","justify-content":"flex-start"}},[a("el-form",{ref:"form",staticClass:"other_form",attrs:{inline:"",model:e.form,"label-width":"80px","label-position":e.labelPosition,size:"mini"}},[a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"文档编号"}},[a("el-input",{model:{value:e.form.fileNo,callback:function(t){e.$set(e.form,"fileNo",t)},expression:"form.fileNo"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"文档名称"}},[a("el-input",{model:{value:e.form.fileName,callback:function(t){e.$set(e.form,"fileName",t)},expression:"form.fileName"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"编制单位"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择科室"},model:{value:e.form.editOffice,callback:function(t){e.$set(e.form,"editOffice",t)},expression:"form.editOffice"}},e._l(e.offices,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"编制人"}},[a("el-input",{model:{value:e.form.editPerson,callback:function(t){e.$set(e.form,"editPerson",t)},expression:"form.editPerson"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"文档类型"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择文档类型"},model:{value:e.form.fileType,callback:function(t){e.$set(e.form,"fileType",t)},expression:"form.fileType"}},[a("el-option",{attrs:{label:"管理规定",value:"管理规定"}}),e._v(" "),a("el-option",{attrs:{label:"管理标准",value:"管理标准"}}),e._v(" "),a("el-option",{attrs:{label:"技术标准",value:"技术标准"}}),e._v(" "),a("el-option",{attrs:{label:"通知",value:"通知"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"职能"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择职能"},model:{value:e.form.major,callback:function(t){e.$set(e.form,"major",t)},expression:"form.major"}},[a("el-option",{attrs:{label:"质量类",value:"质量类"}}),e._v(" "),a("el-option",{attrs:{label:"体系类",value:"体系类"}}),e._v(" "),a("el-option",{attrs:{label:"综合类",value:"综合类"}}),e._v(" "),a("el-option",{attrs:{label:"项目管理",value:"项目管理"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"下发日期"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"month",placeholder:"选择日期","value-format":"yyyy-MM"},model:{value:e.form.issueDate,callback:function(t){e.$set(e.form,"issueDate",t)},expression:"form.issueDate"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"受控状态"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择状态"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[a("el-option",{attrs:{label:"受控",value:"受控"}}),e._v(" "),a("el-option",{attrs:{label:"过期报废",value:"过期报废"}}),e._v(" "),a("el-option",{attrs:{label:"替代报废",value:"替代报废"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"版块"}},[a("el-select",{staticStyle:{width:"60%"},attrs:{clearable:"",placeholder:"请选择版块"},model:{value:e.form.plate,callback:function(t){e.$set(e.form,"plate",t)},expression:"form.plate"}},[a("el-option",{attrs:{label:"电气",value:"电气"}}),e._v(" "),a("el-option",{attrs:{label:"结构",value:"结构"}}),e._v(" "),a("el-option",{attrs:{label:"系统",value:"系统"}}),e._v(" "),a("el-option",{attrs:{label:"整机",value:"整机"}}),e._v(" "),a("el-option",{attrs:{label:"图文",value:"图文"}}),e._v(" "),a("el-option",{attrs:{label:"体系类",value:"体系类"}}),e._v(" "),a("el-option",{attrs:{label:"调度类",value:"调度类"}}),e._v(" "),a("el-option",{attrs:{label:"综合类",value:"综合类"}}),e._v(" "),a("el-option",{attrs:{label:"包装策划",value:"包装策划"}}),e._v(" "),a("el-option",{attrs:{label:"产品成本",value:"产品成本"}}),e._v(" "),a("el-option",{attrs:{label:"成本管理",value:"成本管理"}}),e._v(" "),a("el-option",{attrs:{label:"外购样机",value:"外购样机"}}),e._v(" "),a("el-option",{attrs:{label:"控制器软件",value:"控制器软件"}}),e._v(" "),a("el-option",{attrs:{label:"控制器硬件",value:"控制器硬件"}})],1),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini",round:""},on:{click:e.onSubmit}},[e._v("查询")])],1)],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.list,"max-height":"470","tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[e.$_has("deletePerm")?a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}):e._e(),e._v(" "),a("el-table-column",{attrs:{label:"文档编号",fixed:"",width:"250",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.fileNo))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"文档名称",width:"300",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.fileName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"文档类型",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.fileType))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"编制人",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.editPerson))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"编制单位",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.editOffice))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"下发日期",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.issueDate))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"状态",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.status))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"职能",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.major))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"版块",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.category))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"工作项",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.plate))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right",align:"center",width:"180",height:"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.$_has("editPerm")||t.row.editPerson===e.currentUser.username?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"修改",placement:"top"}},[a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit",round:""},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}})],1):e._e(),e._v(" "),a("el-tooltip",{directives:[{name:"has",rawName:"v-has",value:"deletePerm",expression:"'deletePerm'"}],staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[a("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete",round:""},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"下载",placement:"top"}},[a("el-button",{attrs:{size:"mini",type:"success",icon:"el-icon-download",round:""},on:{click:function(a){return e.handleDownload(t.$index,t.row)}}})],1)]}}])})],1)],1),e._v(" "),a("div",{staticClass:"manage_list_footer"},[a("el-button",{directives:[{name:"has",rawName:"v-has",value:"deletePerm",expression:"'deletePerm'"},{name:"show",rawName:"v-show",value:this.list.length>0,expression:"this.list.length>0 "}],staticStyle:{margin:"0px"},attrs:{type:"danger",size:"mini",disabled:0==this.selItems.length},on:{click:e.deleteMany}},[e._v("批量删除\n\t      ")]),e._v(" "),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:this.list.length>0,expression:"this.list.length>0"}],attrs:{"current-page":e.currentPageNum,"page-size":e.pageSize,layout:"total,prev, pager, next, jumper",total:e.totalCount},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPageNum=t},"update:current-page":function(t){e.currentPageNum=t}}})],1)])},staticRenderFns:[]};var w={data:function(){return{form:{fileNo:"",fileName:"",editOffice:"",editPerson:"",fileType:"",issueDate:"",major:"",plate:"",status:"受控",newVersion:[]},labelPosition:"left",list:[],selItems:[],loading:!1,currentPageNum:1,totalCount:-1,pageSize:10,hasConditions:!1,deleteData:[],offices:[],currentUser:"",tab:"table"}},beforeDestroy:function(){window.bus.$off("table_list")},mounted:function(){this.currentUser=JSON.parse(m("currentUser")),this.loadOffices();this.loading=!0;var e={fileNo:this.form.fileNo,fileName:this.form.fileName,editOffice:this.form.editOffice,editPerson:this.form.editPerson,fileType:this.form.fileType,issueDate:this.form.issueDate,major:this.form.major,plate:this.form.plate,status:this.form.status,tab:this.tab,currentPageNum:this.currentPageNum,pageSize:this.pageSize};this.loadList(e);var t=this;window.bus.$on("table_list",function(){t.loading=!0;var e={fileNo:t.form.fileNo,fileName:t.form.fileName,editOffice:t.form.editOffice,editPerson:t.form.editPerson,fileType:t.form.fileType,issueDate:t.form.issueDate,major:t.form.major,plate:t.form.plate,status:t.form.status,tab:t.tab,currentPageNum:t.currentPageNum,pageSize:t.pageSize};null==e.issueDate&&(e.issueDate=""),t.loadList(e)})},methods:{onSubmit:function(){this.loading=!0;var e={fileNo:this.form.fileNo,fileName:this.form.fileName,editOffice:this.form.editOffice,editPerson:this.form.editPerson,fileType:this.form.fileType,issueDate:this.form.issueDate,major:this.form.major,plate:this.form.plate,status:this.form.status,tab:this.tab,currentPageNum:this.currentPageNum,pageSize:this.pageSize};null==e.issueDate&&(e.issueDate=""),this.loadList(e)},deleteMany:function(){var e=this;this.$confirm("此操作将会删除该文件，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){for(var t=e.selItems,a=0;a<t.length;a++)e.deleteData.push(t[a].id);var l={aids:e.deleteData};e.deleteDocs(l)}).catch(function(){})},handleCurrentChange:function(e){this.currentPageNum=e,this.loading=!0;var t={fileNo:this.form.fileNo,fileName:this.form.fileName,editOffice:this.form.editOffice,editPerson:this.form.editPerson,fileType:this.form.fileType,issueDate:this.form.issueDate,major:this.form.major,plate:this.form.plate,status:this.form.status,tab:this.tab,currentPageNum:this.currentPageNum,pageSize:this.pageSize};null==t.issueDate&&(t.issueDate=""),this.loadList(t)},handleSelectionChange:function(e){this.selItems=e},handleEdit:function(e,t){this.$router.push({name:"上传文档",params:{row:t,flag:!0,changeVersion:!1,isReload:!1}})},handleDelete:function(e,t){var a=this;this.$confirm("此操作将会删除该文件，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.deleteData.length=0,a.deleteData.push(t.id);var e={aids:a.deleteData};a.deleteDocs(e)}).catch(function(){})},handleDownload:function(e,t){var a=this,l={filePath:t.filePath};fe("/anounce/download",l).then(function(e){if(200==e.status){if(0==e.data.size)return void a.$message({type:"error",message:"不存在该文档"});var t=window.URL.createObjectURL(new Blob([e.data])),s=document.createElement("a");s.style.display="none",s.href=t;var i=l.filePath,o=i.lastIndexOf("\\");s.setAttribute("download",i.substring(o,i.length)),document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(s.href),a.$message({type:"success",message:"正在下载！"})}else a.$message({type:"error",message:"下载失败"})})},loadOffices:function(){var e=this;de("/office/all",null).then(function(t){200==t.status?(e.offices=t.data.data,null!=e.list&&(e.list=u(e.list,e.offices))):e.$message({type:"error",message:"科室目录加载失败！"})},function(t){e.$message({type:"error",message:"科室目录加载失败！"})})},loadList:function(e){var t=this;ue("/anounce/all",e).then(function(e){t.loading=!1,200==e.status?(t.list=e.data.data.records,null!=t.offices&&(t.list=u(e.data.data.records,t.offices)),t.totalCount=e.data.data.totalCount):t.$message({type:"error",message:"数据加载失败！"})},function(e){t.loading=!1,403==e.response.status?t.$message({type:"error",message:e.response.data}):t.$message({type:"error",message:"数据加载失败！"})}).catch(function(e){t.loading=!1,t.$message({type:"error",message:"数据加载失败！"})})},deleteDocs:function(e){var t=this;ue("/anounce/delete",e).then(function(e){t.loading=!1,200==e.status?(1e3===e.data.code?(t.$message({type:"success",message:"删除成功！"}),window.bus.$emit("table_list")):t.$message({type:"error",message:"删除失败！"}),t.deleteData.length=0):t.$message({type:"error",message:"删除失败！"})},function(e){t.loading=!1,403==e.response.status?t.$alert("无权限进行删除操作","权限不足",{confirmButtonText:"确定",type:"warning"}):t.$message({type:"error",message:"删除失败！"})})}}},k={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"main_div"},[a("div",{staticClass:"search_div",staticStyle:{display:"flex","justify-content":"flex-start"}},[a("el-form",{ref:"form",staticClass:"other_form",attrs:{inline:"",model:e.form,"label-width":"80px","label-position":e.labelPosition,size:"mini"}},[a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"文档编号"}},[a("el-input",{model:{value:e.form.fileNo,callback:function(t){e.$set(e.form,"fileNo",t)},expression:"form.fileNo"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"文档名称"}},[a("el-input",{model:{value:e.form.fileName,callback:function(t){e.$set(e.form,"fileName",t)},expression:"form.fileName"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"编制单位"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择科室"},model:{value:e.form.editOffice,callback:function(t){e.$set(e.form,"editOffice",t)},expression:"form.editOffice"}},e._l(e.offices,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"编制人"}},[a("el-input",{model:{value:e.form.editPerson,callback:function(t){e.$set(e.form,"editPerson",t)},expression:"form.editPerson"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"文档类型"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择文档类型"},model:{value:e.form.fileType,callback:function(t){e.$set(e.form,"fileType",t)},expression:"form.fileType"}},[a("el-option",{attrs:{label:"综合类",value:"综合类"}}),e._v(" "),a("el-option",{attrs:{label:"管理类",value:"管理类"}}),e._v(" "),a("el-option",{attrs:{label:"专业类",value:"专业类"}}),e._v(" "),a("el-option",{attrs:{label:"模板",value:"模板"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"职能"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择职能"},model:{value:e.form.major,callback:function(t){e.$set(e.form,"major",t)},expression:"form.major"}},[a("el-option",{attrs:{label:"质量类",value:"质量类"}}),e._v(" "),a("el-option",{attrs:{label:"体系类",value:"体系类"}}),e._v(" "),a("el-option",{attrs:{label:"综合类",value:"综合类"}}),e._v(" "),a("el-option",{attrs:{label:"项目管理",value:"项目管理"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"下发日期"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"month",placeholder:"选择日期","value-format":"yyyy-MM"},model:{value:e.form.issueDate,callback:function(t){e.$set(e.form,"issueDate",t)},expression:"form.issueDate"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"受控状态"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择状态"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[a("el-option",{attrs:{label:"受控",value:"受控"}}),e._v(" "),a("el-option",{attrs:{label:"过期报废",value:"过期报废"}}),e._v(" "),a("el-option",{attrs:{label:"替代报废",value:"替代报废"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"版块"}},[a("el-select",{staticStyle:{width:"60%"},attrs:{clearable:"",placeholder:"请选择版块"},model:{value:e.form.plate,callback:function(t){e.$set(e.form,"plate",t)},expression:"form.plate"}},[a("el-option",{attrs:{label:"电气",value:"电气"}}),e._v(" "),a("el-option",{attrs:{label:"结构",value:"结构"}}),e._v(" "),a("el-option",{attrs:{label:"系统",value:"系统"}}),e._v(" "),a("el-option",{attrs:{label:"整机",value:"整机"}}),e._v(" "),a("el-option",{attrs:{label:"图文",value:"图文"}}),e._v(" "),a("el-option",{attrs:{label:"体系类",value:"体系类"}}),e._v(" "),a("el-option",{attrs:{label:"调度类",value:"调度类"}}),e._v(" "),a("el-option",{attrs:{label:"综合类",value:"综合类"}}),e._v(" "),a("el-option",{attrs:{label:"包装策划",value:"包装策划"}}),e._v(" "),a("el-option",{attrs:{label:"产品成本",value:"产品成本"}}),e._v(" "),a("el-option",{attrs:{label:"成本管理",value:"成本管理"}}),e._v(" "),a("el-option",{attrs:{label:"外购样机",value:"外购样机"}}),e._v(" "),a("el-option",{attrs:{label:"控制器软件",value:"控制器软件"}}),e._v(" "),a("el-option",{attrs:{label:"控制器硬件",value:"控制器硬件"}})],1),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini",round:""},on:{click:e.onSubmit}},[e._v("查询")])],1)],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.list,"max-height":"470","tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[e.$_has("deletePerm")?a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}):e._e(),e._v(" "),a("el-table-column",{attrs:{label:"文档编号",fixed:"",width:"250",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.fileNo))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"文档名称",width:"300",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.fileName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"文档类型",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.fileType))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"编制人",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.editPerson))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"编制单位",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.editOffice))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"下发日期",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.issueDate))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"状态",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.status))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"职能",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.major))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"版块",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.category))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"工作项",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.plate))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right",align:"center",width:"180",height:"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.$_has("editPerm")||t.row.editPerson===e.currentUser.username?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"修改",placement:"top"}},[a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit",round:""},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}})],1):e._e(),e._v(" "),a("el-tooltip",{directives:[{name:"has",rawName:"v-has",value:"deletePerm",expression:"'deletePerm'"}],staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[a("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete",round:""},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"下载",placement:"top"}},[a("el-button",{attrs:{size:"mini",type:"success",icon:"el-icon-download",round:""},on:{click:function(a){return e.handleDownload(t.$index,t.row)}}})],1)]}}])})],1)],1),e._v(" "),a("div",{staticClass:"table_list_footer"},[a("el-button",{directives:[{name:"has",rawName:"v-has",value:"deletePerm",expression:"'deletePerm'"},{name:"show",rawName:"v-show",value:this.list.length>0,expression:"this.list.length>0 "}],staticStyle:{margin:"0px"},attrs:{type:"danger",size:"mini",disabled:0==this.selItems.length},on:{click:e.deleteMany}},[e._v("批量删除\n\t      ")]),e._v(" "),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:this.list.length>0,expression:"this.list.length>0"}],attrs:{"current-page":e.currentPageNum,"page-size":e.pageSize,layout:"total,prev, pager, next, jumper",total:e.totalCount},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPageNum=t},"update:current-page":function(t){e.currentPageNum=t}}})],1)])},staticRenderFns:[]};var $={data:function(){return{form:{fileNo:"",fileName:"",editOffice:"",editPerson:"",fileType:"",issueDate:"",major:"",plate:"",status:"受控"},labelPosition:"left",list:[],selItems:[],loading:!1,currentPageNum:1,totalCount:-1,pageSize:10,hasConditions:!1,deleteData:[],offices:[],currentUser:"",tab:"redtape"}},beforeDestroy:function(){window.bus.$off("redtape_list")},mounted:function(){this.currentUser=JSON.parse(m("currentUser")),this.loadOffices();this.loading=!0;var e={fileNo:this.form.fileNo,fileName:this.form.fileName,editOffice:this.form.editOffice,editPerson:this.form.editPerson,fileType:this.form.fileType,issueDate:this.form.issueDate,major:this.form.major,plate:this.form.plate,status:this.form.status,tab:this.tab,currentPageNum:this.currentPageNum,pageSize:this.pageSize};this.loadList(e);var t=this;window.bus.$on("redtape_list",function(){t.loading=!0;var e={fileNo:t.form.fileNo,fileName:t.form.fileName,editOffice:t.form.editOffice,editPerson:t.form.editPerson,fileType:t.form.fileType,issueDate:t.form.issueDate,major:t.form.major,plate:t.form.plate,status:t.form.status,tab:t.tab,currentPageNum:t.currentPageNum,pageSize:t.pageSize};null==e.issueDate&&(e.issueDate=""),t.loadList(e)})},methods:{onSubmit:function(){this.loading=!0;var e={fileNo:this.form.fileNo,fileName:this.form.fileName,editOffice:this.form.editOffice,editPerson:this.form.editPerson,fileType:this.form.fileType,issueDate:this.form.issueDate,major:this.form.major,plate:this.form.plate,status:this.form.status,tab:this.tab,currentPageNum:this.currentPageNum,pageSize:this.pageSize};null==e.issueDate&&(e.issueDate=""),this.loadList(e)},deleteMany:function(){var e=this;this.$confirm("此操作将会删除该文件，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){for(var t=e.selItems,a=0;a<t.length;a++)e.deleteData.push(t[a].id);var l={aids:e.deleteData};e.deleteDocs(l)}).catch(function(){})},handleCurrentChange:function(e){this.currentPageNum=e,this.loading=!0;var t={fileNo:this.form.fileNo,fileName:this.form.fileName,editOffice:this.form.editOffice,editPerson:this.form.editPerson,fileType:this.form.fileType,issueDate:this.form.issueDate,major:this.form.major,plate:this.form.plate,status:this.form.status,tab:this.tab,currentPageNum:this.currentPageNum,pageSize:this.pageSize};null==t.issueDate&&(t.issueDate=""),this.loadList(t)},handleSelectionChange:function(e){this.selItems=e},handleEdit:function(e,t){this.$router.push({name:"上传文档",params:{row:t,flag:!0,changeVersion:!1,isReload:!1}})},handleDelete:function(e,t){var a=this;this.$confirm("此操作将会删除该文件，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.deleteData.length=0,a.deleteData.push(t.id);var e={aids:a.deleteData};a.deleteDocs(e)}).catch(function(){})},handleDownload:function(e,t){var a=this,l={filePath:t.filePath};fe("/anounce/download",l).then(function(e){if(200==e.status){if(0==e.data.size)return void a.$message({type:"error",message:"不存在该文档"});var t=window.URL.createObjectURL(new Blob([e.data])),s=document.createElement("a");s.style.display="none",s.href=t;var i=l.filePath,o=i.lastIndexOf("\\");s.setAttribute("download",i.substring(o,i.length)),document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(s.href),a.$message({type:"success",message:"正在下载！"})}else a.$message({type:"error",message:"下载失败"})})},loadOffices:function(){var e=this;de("/office/all",null).then(function(t){200==t.status?(e.offices=t.data.data,null!=e.list&&(e.list=u(e.list,e.offices))):e.$message({type:"error",message:"科室目录加载失败！"})},function(t){e.$message({type:"error",message:"科室目录加载失败！"})})},loadList:function(e){var t=this;ue("/anounce/all",e).then(function(e){t.loading=!1,200==e.status?(t.list=e.data.data.records,null!=t.offices&&(t.list=u(e.data.data.records,t.offices)),t.totalCount=e.data.data.totalCount):t.$message({type:"error",message:"数据加载失败！"})},function(e){t.loading=!1,403==e.response.status?t.$message({type:"error",message:e.response.data}):t.$message({type:"error",message:"数据加载失败！"})}).catch(function(e){t.loading=!1,t.$message({type:"error",message:"数据加载失败！"})})},deleteDocs:function(e){var t=this;ue("/anounce/delete",e).then(function(e){t.loading=!1,200==e.status?(1e3===e.data.code?(t.$message({type:"success",message:"删除成功！"}),window.bus.$emit("redtape_list")):t.$message({type:"error",message:"删除失败！"}),t.deleteData.length=0):t.$message({type:"error",message:"删除失败！"})},function(e){t.loading=!1,403==e.response.status?t.$alert("无权限进行删除操作","权限不足",{confirmButtonText:"确定",type:"warning"}):t.$message({type:"error",message:"删除失败！"})})}},props:["activeName"]},N={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"main_div"},[a("div",{staticClass:"search_div",staticStyle:{display:"flex","justify-content":"flex-start"}},[a("el-form",{ref:"form",staticClass:"other_form",attrs:{inline:"",model:e.form,"label-width":"80px","label-position":e.labelPosition,size:"mini"}},[a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"文档编号"}},[a("el-input",{model:{value:e.form.fileNo,callback:function(t){e.$set(e.form,"fileNo",t)},expression:"form.fileNo"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"文档名称"}},[a("el-input",{model:{value:e.form.fileName,callback:function(t){e.$set(e.form,"fileName",t)},expression:"form.fileName"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"编制单位"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择科室"},model:{value:e.form.editOffice,callback:function(t){e.$set(e.form,"editOffice",t)},expression:"form.editOffice"}},e._l(e.offices,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"编制人"}},[a("el-input",{model:{value:e.form.editPerson,callback:function(t){e.$set(e.form,"editPerson",t)},expression:"form.editPerson"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"文档类型"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择文档类型"},model:{value:e.form.fileType,callback:function(t){e.$set(e.form,"fileType",t)},expression:"form.fileType"}},[a("el-option",{attrs:{label:"红头文件",value:"红头文件"}}),e._v(" "),a("el-option",{attrs:{label:"体系通报",value:"体系通报"}}),e._v(" "),a("el-option",{attrs:{label:"表扬通报",value:"表扬通报"}}),e._v(" "),a("el-option",{attrs:{label:"质量黑榜",value:"质量黑榜"}}),e._v(" "),a("el-option",{attrs:{label:"内部通报",value:"内部通报"}}),e._v(" "),a("el-option",{attrs:{label:"职能通报",value:"职能通报"}}),e._v(" "),a("el-option",{attrs:{label:"其他",value:"其他"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"职能"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择职能"},model:{value:e.form.major,callback:function(t){e.$set(e.form,"major",t)},expression:"form.major"}},[a("el-option",{attrs:{label:"质量类",value:"质量类"}}),e._v(" "),a("el-option",{attrs:{label:"体系类",value:"体系类"}}),e._v(" "),a("el-option",{attrs:{label:"综合类",value:"综合类"}}),e._v(" "),a("el-option",{attrs:{label:"项目管理",value:"项目管理"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"下发日期"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"month",placeholder:"选择日期","value-format":"yyyy-MM"},model:{value:e.form.issueDate,callback:function(t){e.$set(e.form,"issueDate",t)},expression:"form.issueDate"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"受控状态"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择状态"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[a("el-option",{attrs:{label:"受控",value:"受控"}}),e._v(" "),a("el-option",{attrs:{label:"过期报废",value:"过期报废"}}),e._v(" "),a("el-option",{attrs:{label:"替代报废",value:"替代报废"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"版块"}},[a("el-select",{staticStyle:{width:"60%"},attrs:{clearable:"",placeholder:"请选择版块"},model:{value:e.form.plate,callback:function(t){e.$set(e.form,"plate",t)},expression:"form.plate"}},[a("el-option",{attrs:{label:"电气",value:"电气"}}),e._v(" "),a("el-option",{attrs:{label:"结构",value:"结构"}}),e._v(" "),a("el-option",{attrs:{label:"系统",value:"系统"}}),e._v(" "),a("el-option",{attrs:{label:"整机",value:"整机"}}),e._v(" "),a("el-option",{attrs:{label:"图文",value:"图文"}}),e._v(" "),a("el-option",{attrs:{label:"体系类",value:"体系类"}}),e._v(" "),a("el-option",{attrs:{label:"调度类",value:"调度类"}}),e._v(" "),a("el-option",{attrs:{label:"综合类",value:"综合类"}}),e._v(" "),a("el-option",{attrs:{label:"包装策划",value:"包装策划"}}),e._v(" "),a("el-option",{attrs:{label:"产品成本",value:"产品成本"}}),e._v(" "),a("el-option",{attrs:{label:"成本管理",value:"成本管理"}}),e._v(" "),a("el-option",{attrs:{label:"外购样机",value:"外购样机"}}),e._v(" "),a("el-option",{attrs:{label:"控制器软件",value:"控制器软件"}}),e._v(" "),a("el-option",{attrs:{label:"控制器硬件",value:"控制器硬件"}})],1),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini",round:""},on:{click:e.onSubmit}},[e._v("查询")])],1)],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.list,"max-height":"470","tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[e.$_has("deletePerm")?a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}):e._e(),e._v(" "),a("el-table-column",{attrs:{label:"文档编号",fixed:"",width:"250",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.fileNo))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"文档名称",width:"300",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.fileName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"文档类型",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.fileType))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"编制人",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.editPerson))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"编制单位",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.editOffice))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"下发日期",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.issueDate))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"状态",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.status))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"职能",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.major))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"版块",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.category))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"工作项",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.plate))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right",align:"center",width:"180",height:"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.$_has("editPerm")||t.row.editPerson===e.currentUser.username?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"修改",placement:"top"}},[a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit",round:""},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}})],1):e._e(),e._v(" "),a("el-tooltip",{directives:[{name:"has",rawName:"v-has",value:"deletePerm",expression:"'deletePerm'"}],staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[a("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete",round:""},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"下载",placement:"top"}},[a("el-button",{attrs:{size:"mini",type:"success",icon:"el-icon-download",round:""},on:{click:function(a){return e.handleDownload(t.$index,t.row)}}})],1)]}}])})],1)],1),e._v(" "),a("div",{staticClass:"redtape_list_footer"},[a("el-button",{directives:[{name:"has",rawName:"v-has",value:"deletePerm",expression:"'deletePerm'"},{name:"show",rawName:"v-show",value:this.list.length>0,expression:"this.list.length>0 "}],staticStyle:{margin:"0px"},attrs:{type:"danger",size:"mini",disabled:0==this.selItems.length},on:{click:e.deleteMany}},[e._v("批量删除\n\t      ")]),e._v(" "),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:this.list.length>0,expression:"this.list.length>0"}],attrs:{"current-page":e.currentPageNum,"page-size":e.pageSize,layout:"total,prev, pager, next, jumper",total:e.totalCount},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPageNum=t},"update:current-page":function(t){e.currentPageNum=t}}})],1)])},staticRenderFns:[]};var S={data:function(){return{form:{fileNo:"",fileName:"",editOffice:"",editPerson:"",fileType:"任务单",issueDate:"",major:"",plate:"",status:"受控"},labelPosition:"left",list:[],selItems:[],loading:!1,currentPageNum:1,totalCount:-1,pageSize:10,hasConditions:!1,deleteData:[],offices:[],currentUser:"",tab:"task"}},beforeDestroy:function(){window.bus.$off("task_list")},mounted:function(){this.currentUser=JSON.parse(m("currentUser")),this.loadOffices();this.loading=!0;var e={fileNo:this.form.fileNo,fileName:this.form.fileName,editOffice:this.form.editOffice,editPerson:this.form.editPerson,fileType:this.form.fileType,issueDate:this.form.issueDate,major:this.form.major,plate:this.form.plate,status:this.form.status,tab:this.tab,currentPageNum:this.currentPageNum,pageSize:this.pageSize};this.loadList(e);var t=this;window.bus.$on("task_list",function(){t.loading=!0;var e={fileNo:t.form.fileNo,fileName:t.form.fileName,editOffice:t.form.editOffice,editPerson:t.form.editPerson,fileType:t.form.fileType,issueDate:t.form.issueDate,major:t.form.major,plate:t.form.plate,status:t.form.status,tab:t.tab,currentPageNum:t.currentPageNum,pageSize:t.pageSize};null==e.issueDate&&(e.issueDate=""),t.loadList(e)})},methods:{onSubmit:function(){this.loading=!0;var e={fileNo:this.form.fileNo,fileName:this.form.fileName,editOffice:this.form.editOffice,editPerson:this.form.editPerson,fileType:this.form.fileType,issueDate:this.form.issueDate,major:this.form.major,plate:this.form.plate,status:this.form.status,tab:this.tab,currentPageNum:this.currentPageNum,pageSize:this.pageSize};null==e.issueDate&&(e.issueDate=""),this.loadList(e)},deleteMany:function(){var e=this;this.$confirm("此操作将会删除该文件，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){for(var t=e.selItems,a=0;a<t.length;a++)e.deleteData.push(t[a].id);var l={aids:e.deleteData};e.deleteDocs(l)}).catch(function(){})},handleCurrentChange:function(e){this.currentPageNum=e,this.loading=!0;var t={fileNo:this.form.fileNo,fileName:this.form.fileName,editOffice:this.form.editOffice,editPerson:this.form.editPerson,fileType:this.form.fileType,issueDate:this.form.issueDate,major:this.form.major,plate:this.form.plate,status:this.form.status,tab:this.tab,currentPageNum:this.currentPageNum,pageSize:this.pageSize};null==t.issueDate&&(t.issueDate=""),this.loadList(t)},handleSelectionChange:function(e){this.selItems=e},handleEdit:function(e,t){this.$router.push({name:"上传文档",params:{row:t,flag:!0,changeVersion:!1,isReload:!1}})},handleDelete:function(e,t){var a=this;this.$confirm("此操作将会删除该文件，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.deleteData.length=0,a.deleteData.push(t.id);var e={aids:a.deleteData};a.deleteDocs(e)}).catch(function(){})},handleDownload:function(e,t){var a=this,l={filePath:t.filePath};fe("/anounce/download",l).then(function(e){if(200==e.status){if(0==e.data.size)return void a.$message({type:"error",message:"不存在该文档"});var t=window.URL.createObjectURL(new Blob([e.data])),s=document.createElement("a");s.style.display="none",s.href=t;var i=l.filePath,o=i.lastIndexOf("\\");s.setAttribute("download",i.substring(o,i.length)),document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(s.href),a.$message({type:"success",message:"正在下载！"})}else a.$message({type:"error",message:"下载失败"})})},loadOffices:function(){var e=this;de("/office/all",null).then(function(t){200==t.status?(e.offices=t.data.data,null!=e.list&&(e.list=u(e.list,e.offices))):e.$message({type:"error",message:"科室目录加载失败！"})},function(t){e.$message({type:"error",message:"科室目录加载失败！"})})},loadList:function(e){var t=this;ue("/anounce/all",e).then(function(e){t.loading=!1,200==e.status?(t.list=e.data.data.records,null!=t.offices&&(t.list=u(e.data.data.records,t.offices)),t.totalCount=e.data.data.totalCount):t.$message({type:"error",message:"数据加载失败！"})},function(e){t.loading=!1,403==e.response.status?t.$message({type:"error",message:e.response.data}):t.$message({type:"error",message:"数据加载失败！"})}).catch(function(e){t.loading=!1,t.$message({type:"error",message:"数据加载失败！"})})},deleteDocs:function(e){var t=this;ue("/anounce/delete",e).then(function(e){t.loading=!1,200==e.status?(1e3===e.data.code?(t.$message({type:"success",message:"删除成功！"}),window.bus.$emit("task_list")):t.$message({type:"error",message:"删除失败！"}),t.deleteData.length=0):t.$message({type:"error",message:"删除失败！"})},function(e){t.loading=!1,403==e.response.status?t.$alert("无权限进行删除操作","权限不足",{confirmButtonText:"确定",type:"warning"}):t.$message({type:"error",message:"删除失败！"})})}},props:["activeName"]},x={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"main_div"},[a("div",{staticClass:"search_div",staticStyle:{display:"flex","justify-content":"flex-start"}},[a("el-form",{ref:"form",staticClass:"other_form",attrs:{inline:"",model:e.form,"label-width":"80px","label-position":e.labelPosition,size:"mini"}},[a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"文档编号"}},[a("el-input",{model:{value:e.form.fileNo,callback:function(t){e.$set(e.form,"fileNo",t)},expression:"form.fileNo"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"文档名称"}},[a("el-input",{model:{value:e.form.fileName,callback:function(t){e.$set(e.form,"fileName",t)},expression:"form.fileName"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"编制单位"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择科室"},model:{value:e.form.editOffice,callback:function(t){e.$set(e.form,"editOffice",t)},expression:"form.editOffice"}},e._l(e.offices,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"编制人"}},[a("el-input",{model:{value:e.form.editPerson,callback:function(t){e.$set(e.form,"editPerson",t)},expression:"form.editPerson"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"职能"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择职能"},model:{value:e.form.major,callback:function(t){e.$set(e.form,"major",t)},expression:"form.major"}},[a("el-option",{attrs:{label:"质量类",value:"质量类"}}),e._v(" "),a("el-option",{attrs:{label:"体系类",value:"体系类"}}),e._v(" "),a("el-option",{attrs:{label:"综合类",value:"综合类"}}),e._v(" "),a("el-option",{attrs:{label:"项目管理",value:"项目管理"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"下发日期"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"month",placeholder:"选择日期","value-format":"yyyy-MM"},model:{value:e.form.issueDate,callback:function(t){e.$set(e.form,"issueDate",t)},expression:"form.issueDate"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"受控状态"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择状态"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[a("el-option",{attrs:{label:"受控",value:"受控"}}),e._v(" "),a("el-option",{attrs:{label:"过期报废",value:"过期报废"}}),e._v(" "),a("el-option",{attrs:{label:"替代报废",value:"替代报废"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"版块"}},[a("el-select",{staticStyle:{width:"60%"},attrs:{clearable:"",placeholder:"请选择版块"},model:{value:e.form.plate,callback:function(t){e.$set(e.form,"plate",t)},expression:"form.plate"}},[a("el-option",{attrs:{label:"电气",value:"电气"}}),e._v(" "),a("el-option",{attrs:{label:"结构",value:"结构"}}),e._v(" "),a("el-option",{attrs:{label:"系统",value:"系统"}}),e._v(" "),a("el-option",{attrs:{label:"整机",value:"整机"}}),e._v(" "),a("el-option",{attrs:{label:"图文",value:"图文"}}),e._v(" "),a("el-option",{attrs:{label:"体系类",value:"体系类"}}),e._v(" "),a("el-option",{attrs:{label:"调度类",value:"调度类"}}),e._v(" "),a("el-option",{attrs:{label:"综合类",value:"综合类"}}),e._v(" "),a("el-option",{attrs:{label:"包装策划",value:"包装策划"}}),e._v(" "),a("el-option",{attrs:{label:"产品成本",value:"产品成本"}}),e._v(" "),a("el-option",{attrs:{label:"成本管理",value:"成本管理"}}),e._v(" "),a("el-option",{attrs:{label:"外购样机",value:"外购样机"}}),e._v(" "),a("el-option",{attrs:{label:"控制器软件",value:"控制器软件"}}),e._v(" "),a("el-option",{attrs:{label:"控制器硬件",value:"控制器硬件"}})],1),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini",round:""},on:{click:e.onSubmit}},[e._v("查询")])],1)],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.list,"max-height":"470","tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[e.$_has("deletePerm")?a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}):e._e(),e._v(" "),a("el-table-column",{attrs:{label:"文档编号",fixed:"",width:"250",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.fileNo))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"文档名称",width:"300",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.fileName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"文档类型",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.fileType))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"编制人",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.editPerson))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"编制单位",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.editOffice))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"下发日期",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.issueDate))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"状态",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.status))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"职能",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.major))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"版块",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.category))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"工作项",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.plate))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right",align:"center",width:"180",height:"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.$_has("editPerm")||t.row.editPerson===e.currentUser.username?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"修改",placement:"top"}},[a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit",round:""},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}})],1):e._e(),e._v(" "),a("el-tooltip",{directives:[{name:"has",rawName:"v-has",value:"deletePerm",expression:"'deletePerm'"}],staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[a("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete",round:""},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"下载",placement:"top"}},[a("el-button",{attrs:{size:"mini",type:"success",icon:"el-icon-download",round:""},on:{click:function(a){return e.handleDownload(t.$index,t.row)}}})],1)]}}])})],1)],1),e._v(" "),a("div",{staticClass:"task_list_footer"},[a("el-button",{directives:[{name:"has",rawName:"v-has",value:"deletePerm",expression:"'deletePerm'"},{name:"show",rawName:"v-show",value:this.list.length>0,expression:"this.list.length>0 "}],staticStyle:{margin:"0px"},attrs:{type:"danger",size:"mini",disabled:0==this.selItems.length},on:{click:e.deleteMany}},[e._v("批量删除\n\t      ")]),e._v(" "),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:this.list.length>0,expression:"this.list.length>0"}],attrs:{"current-page":e.currentPageNum,"page-size":e.pageSize,layout:"total,prev, pager, next, jumper",total:e.totalCount},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPageNum=t},"update:current-page":function(t){e.currentPageNum=t}}})],1)])},staticRenderFns:[]};var P={data:function(){return{form:{fileNo:"",fileName:"",editOffice:"",editPerson:"",fileType:"作业指导书",issueDate:"",major:"",plate:"",status:"受控"},labelPosition:"left",list:[],selItems:[],loading:!1,currentPageNum:1,totalCount:-1,pageSize:10,hasConditions:!1,deleteData:[],offices:[],currentUser:"",tab:"work"}},beforeDestroy:function(){window.bus.$off("work_list")},mounted:function(){this.currentUser=JSON.parse(m("currentUser")),this.loadOffices();this.loading=!0;var e={fileNo:this.form.fileNo,fileName:this.form.fileName,editOffice:this.form.editOffice,editPerson:this.form.editPerson,fileType:this.form.fileType,issueDate:this.form.issueDate,major:this.form.major,plate:this.form.plate,status:this.form.status,tab:this.tab,currentPageNum:this.currentPageNum,pageSize:this.pageSize};null==e.issueDate&&(e.issueDate=""),this.loadList(e);var t=this;window.bus.$on("work_list",function(){t.loading=!0;var e={fileNo:t.form.fileNo,fileName:t.form.fileName,editOffice:t.form.editOffice,editPerson:t.form.editPerson,fileType:t.form.fileType,issueDate:t.form.issueDate,major:t.form.major,plate:t.form.plate,status:t.form.status,tab:t.tab,currentPageNum:t.currentPageNum,pageSize:t.pageSize};null==e.issueDate&&(e.issueDate=""),t.loadList(e)})},methods:{onSubmit:function(){this.loading=!0;var e={fileNo:this.form.fileNo,fileName:this.form.fileName,editOffice:this.form.editOffice,editPerson:this.form.editPerson,fileType:this.form.fileType,issueDate:this.form.issueDate,major:this.form.major,plate:this.form.plate,status:this.form.status,tab:this.tab,currentPageNum:this.currentPageNum,pageSize:this.pageSize};null==e.issueDate&&(e.issueDate=""),this.loadList(e)},deleteMany:function(){var e=this;this.$confirm("此操作将会删除该文件，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){for(var t=e.selItems,a=0;a<t.length;a++)e.deleteData.push(t[a].id);var l={aids:e.deleteData};e.deleteDocs(l)}).catch(function(){})},handleCurrentChange:function(e){this.currentPageNum=e,this.loading=!0;var t={fileNo:this.form.fileNo,fileName:this.form.fileName,editOffice:this.form.editOffice,editPerson:this.form.editPerson,fileType:this.form.fileType,issueDate:this.form.issueDate,major:this.form.major,plate:this.form.plate,status:this.form.status,tab:this.tab,currentPageNum:this.currentPageNum,pageSize:this.pageSize};null==t.issueDate&&(t.issueDate=""),this.loadList(t)},handleSelectionChange:function(e){this.selItems=e},handleEdit:function(e,t){this.$router.push({name:"上传文档",params:{row:t,flag:!0,changeVersion:!1,isReload:!1}})},handleDelete:function(e,t){var a=this;this.$confirm("此操作将会删除该文件，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.deleteData.length=0,a.deleteData.push(t.id);var e={aids:a.deleteData};a.deleteDocs(e)}).catch(function(){})},handleDownload:function(e,t){var a=this,l={filePath:t.filePath};fe("/anounce/download",l).then(function(e){if(200==e.status){if(0==e.data.size)return void a.$message({type:"error",message:"不存在该文档"});var t=window.URL.createObjectURL(new Blob([e.data])),s=document.createElement("a");s.style.display="none",s.href=t;var i=l.filePath,o=i.lastIndexOf("\\");s.setAttribute("download",i.substring(o,i.length)),document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(s.href),a.$message({type:"success",message:"正在下载！"})}else a.$message({type:"error",message:"下载失败"})})},loadOffices:function(){var e=this;de("/office/all",null).then(function(t){200==t.status?(e.offices=t.data.data,null!=e.list&&(e.list=u(e.list,e.offices))):e.$message({type:"error",message:"科室目录加载失败！"})},function(t){e.$message({type:"error",message:"科室目录加载失败！"})})},loadList:function(e){var t=this;ue("/anounce/all",e).then(function(e){t.loading=!1,200==e.status?(t.list=e.data.data.records,null!=t.offices&&(t.list=u(e.data.data.records,t.offices)),t.totalCount=e.data.data.totalCount):t.$message({type:"error",message:"数据加载失败！"})},function(e){t.loading=!1,403==e.response.status?t.$message({type:"error",message:e.response.data}):t.$message({type:"error",message:"数据加载失败！"})}).catch(function(e){t.loading=!1,t.$message({type:"error",message:"数据加载失败！"})})},deleteDocs:function(e){var t=this;ue("/anounce/delete",e).then(function(e){t.loading=!1,200==e.status?(1e3===e.data.code?(t.$message({type:"success",message:"删除成功！"}),window.bus.$emit("work_list")):t.$message({type:"error",message:"删除失败！"}),t.deleteData.length=0):t.$message({type:"error",message:"删除失败！"})},function(e){t.loading=!1,403==e.response.status?t.$alert("无权限进行删除操作","权限不足",{confirmButtonText:"确定",type:"warning"}):t.$message({type:"error",message:"删除失败！"})})}}},D={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"main_div"},[a("div",{staticClass:"search_div",staticStyle:{display:"flex","justify-content":"flex-start"}},[a("el-form",{ref:"form",staticClass:"other_form",attrs:{inline:"",model:e.form,"label-width":"80px","label-position":e.labelPosition,size:"mini"}},[a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"文档编号"}},[a("el-input",{model:{value:e.form.fileNo,callback:function(t){e.$set(e.form,"fileNo",t)},expression:"form.fileNo"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"文档名称"}},[a("el-input",{model:{value:e.form.fileName,callback:function(t){e.$set(e.form,"fileName",t)},expression:"form.fileName"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"编制单位"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择科室"},model:{value:e.form.editOffice,callback:function(t){e.$set(e.form,"editOffice",t)},expression:"form.editOffice"}},e._l(e.offices,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"编制人"}},[a("el-input",{model:{value:e.form.editPerson,callback:function(t){e.$set(e.form,"editPerson",t)},expression:"form.editPerson"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"职能"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择职能"},model:{value:e.form.major,callback:function(t){e.$set(e.form,"major",t)},expression:"form.major"}},[a("el-option",{attrs:{label:"质量类",value:"质量类"}}),e._v(" "),a("el-option",{attrs:{label:"体系类",value:"体系类"}}),e._v(" "),a("el-option",{attrs:{label:"综合类",value:"综合类"}}),e._v(" "),a("el-option",{attrs:{label:"项目管理",value:"项目管理"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"下发日期"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"month",placeholder:"选择日期","value-format":"yyyy-MM"},model:{value:e.form.issueDate,callback:function(t){e.$set(e.form,"issueDate",t)},expression:"form.issueDate"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"受控状态"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择状态"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[a("el-option",{attrs:{label:"受控",value:"受控"}}),e._v(" "),a("el-option",{attrs:{label:"过期报废",value:"过期报废"}}),e._v(" "),a("el-option",{attrs:{label:"替代报废",value:"替代报废"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"版块"}},[a("el-select",{staticStyle:{width:"60%"},attrs:{clearable:"",placeholder:"请选择版块"},model:{value:e.form.plate,callback:function(t){e.$set(e.form,"plate",t)},expression:"form.plate"}},[a("el-option",{attrs:{label:"电气",value:"电气"}}),e._v(" "),a("el-option",{attrs:{label:"结构",value:"结构"}}),e._v(" "),a("el-option",{attrs:{label:"系统",value:"系统"}}),e._v(" "),a("el-option",{attrs:{label:"整机",value:"整机"}}),e._v(" "),a("el-option",{attrs:{label:"图文",value:"图文"}}),e._v(" "),a("el-option",{attrs:{label:"体系类",value:"体系类"}}),e._v(" "),a("el-option",{attrs:{label:"调度类",value:"调度类"}}),e._v(" "),a("el-option",{attrs:{label:"综合类",value:"综合类"}}),e._v(" "),a("el-option",{attrs:{label:"包装策划",value:"包装策划"}}),e._v(" "),a("el-option",{attrs:{label:"产品成本",value:"产品成本"}}),e._v(" "),a("el-option",{attrs:{label:"成本管理",value:"成本管理"}}),e._v(" "),a("el-option",{attrs:{label:"外购样机",value:"外购样机"}}),e._v(" "),a("el-option",{attrs:{label:"控制器软件",value:"控制器软件"}}),e._v(" "),a("el-option",{attrs:{label:"控制器硬件",value:"控制器硬件"}})],1),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini",round:""},on:{click:e.onSubmit}},[e._v("查询")])],1)],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.list,"max-height":"470","tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[e.$_has("deletePerm")?a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}):e._e(),e._v(" "),a("el-table-column",{attrs:{label:"文档编号",fixed:"",width:"250",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.fileNo))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"文档名称",width:"300",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.fileName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"文档类型",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.fileType))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"编制人",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.editPerson))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"编制单位",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.editOffice))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"下发日期",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.issueDate))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"状态",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.status))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"职能",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.major))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"版块",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.category))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"工作项",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.plate))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right",align:"center",width:"180",height:"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.$_has("editPerm")||t.row.editPerson===e.currentUser.username?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"修改",placement:"top"}},[a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit",round:""},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}})],1):e._e(),e._v(" "),a("el-tooltip",{directives:[{name:"has",rawName:"v-has",value:"deletePerm",expression:"'deletePerm'"}],staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[a("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete",round:""},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"下载",placement:"top"}},[a("el-button",{attrs:{size:"mini",type:"success",icon:"el-icon-download",round:""},on:{click:function(a){return e.handleDownload(t.$index,t.row)}}})],1)]}}])})],1)],1),e._v(" "),a("div",{staticClass:"work_list_footer"},[a("el-button",{directives:[{name:"has",rawName:"v-has",value:"deletePerm",expression:"'deletePerm'"},{name:"show",rawName:"v-show",value:this.list.length>0,expression:"this.list.length>0 "}],staticStyle:{margin:"0px"},attrs:{type:"danger",size:"mini",disabled:0==this.selItems.length},on:{click:e.deleteMany}},[e._v("批量删除\n\t      ")]),e._v(" "),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:this.list.length>0,expression:"this.list.length>0"}],attrs:{"current-page":e.currentPageNum,"page-size":e.pageSize,layout:"total,prev, pager, next, jumper",total:e.totalCount},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPageNum=t},"update:current-page":function(t){e.currentPageNum=t}}})],1)])},staticRenderFns:[]};var C={data:function(){return{form:{fileNo:"",fileName:"",editOffice:"",editPerson:"",fileType:"分析报告",issueDate:"",major:"",plate:"",status:"受控",newVersion:[]},labelPosition:"left",list:[],selItems:[],loading:!1,currentPageNum:1,totalCount:-1,pageSize:10,hasConditions:!1,deleteData:[],offices:[],currentUser:"",tab:"analysis"}},beforeDestroy:function(){window.bus.$off("analysis_list")},mounted:function(){this.currentUser=JSON.parse(m("currentUser")),this.loadOffices();this.loading=!0;var e={fileNo:this.form.fileNo,fileName:this.form.fileName,editOffice:this.form.editOffice,editPerson:this.form.editPerson,fileType:this.form.fileType,issueDate:this.form.issueDate,major:this.form.major,plate:this.form.plate,status:this.form.status,tab:this.tab,currentPageNum:this.currentPageNum,pageSize:this.pageSize};null==e.issueDate&&(e.issueDate=""),this.form.newVersion.length>0?"是"===this.form.newVersion[0]?e.newVersion="1":e.newVersion="0":e.newVersion="",this.loadList(e);var t=this;window.bus.$on("analysisi_list",function(){t.loading=!0;var e={fileNo:t.form.fileNo,fileName:t.form.fileName,editOffice:t.form.editOffice,editPerson:t.form.editPerson,fileType:t.form.fileType,issueDate:t.form.issueDate,major:t.form.major,plate:t.form.plate,status:t.form.status,tab:t.tab,currentPageNum:t.currentPageNum,pageSize:t.pageSize};null==e.issueDate&&(e.issueDate=""),t.form.newVersion.length>0?"是"===t.form.newVersion[0]?e.newVersion="1":e.newVersion="0":e.newVersion="",t.loadList(e)})},methods:{onSubmit:function(){this.loading=!0;var e={fileNo:this.form.fileNo,fileName:this.form.fileName,editOffice:this.form.editOffice,editPerson:this.form.editPerson,fileType:this.form.fileType,issueDate:this.form.issueDate,major:this.form.major,plate:this.form.plate,status:this.form.status,tab:this.tab,currentPageNum:this.currentPageNum,pageSize:this.pageSize};null==e.issueDate&&(e.issueDate=""),this.form.newVersion.length>0?"是"===this.form.newVersion[0]?e.newVersion="1":e.newVersion="0":e.newVersion="",this.loadList(e)},deleteMany:function(){var e=this;this.$confirm("此操作将会删除该文件，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){for(var t=e.selItems,a=0;a<t.length;a++)e.deleteData.push(t[a].id);var l={aids:e.deleteData};e.deleteDocs(l)}).catch(function(){})},handleCurrentChange:function(e){this.currentPageNum=e,this.loading=!0;var t={fileNo:this.form.fileNo,fileName:this.form.fileName,editOffice:this.form.editOffice,editPerson:this.form.editPerson,fileType:this.form.fileType,issueDate:this.form.issueDate,major:this.form.major,plate:this.form.plate,status:this.form.status,tab:this.tab,currentPageNum:this.currentPageNum,pageSize:this.pageSize};null==t.issueDate&&(t.issueDate=""),this.form.newVersion.length>0?"是"===this.form.newVersion[0]?t.newVersion="1":t.newVersion="0":t.newVersion="",this.loadList(t)},handleSelectionChange:function(e){this.selItems=e},handleEdit:function(e,t){this.$router.push({name:"上传文档",params:{row:t,flag:!0,changeVersion:!1,isReload:!1}})},handleDelete:function(e,t){var a=this;this.$confirm("此操作将会删除该文件，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.deleteData.length=0,a.deleteData.push(t.id);var e={aids:a.deleteData};a.deleteDocs(e)}).catch(function(){})},handleDownload:function(e,t){var a=this,l={filePath:t.filePath};fe("/anounce/download",l).then(function(e){if(200==e.status){if(0==e.data.size)return void a.$message({type:"error",message:"不存在该文档"});var t=window.URL.createObjectURL(new Blob([e.data])),s=document.createElement("a");s.style.display="none",s.href=t;var i=l.filePath,o=i.lastIndexOf("\\");s.setAttribute("download",i.substring(o,i.length)),document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(s.href),a.$message({type:"success",message:"正在下载！"})}else a.$message({type:"error",message:"下载失败"})})},loadOffices:function(){var e=this;de("/office/all",null).then(function(t){200==t.status?(e.offices=t.data.data,null!=e.list&&(e.list=u(e.list,e.offices))):e.$message({type:"error",message:"科室目录加载失败！"})},function(t){e.$message({type:"error",message:"科室目录加载失败！"})})},loadList:function(e){var t=this;ue("/anounce/all",e).then(function(e){t.loading=!1,200==e.status?(t.list=e.data.data.records,null!=t.offices&&(t.list=u(e.data.data.records,t.offices)),t.totalCount=e.data.data.totalCount):t.$message({type:"error",message:"数据加载失败！"})},function(e){t.loading=!1,403==e.response.status?t.$message({type:"error",message:e.response.data.data}):t.$message({type:"error",message:"数据加载失败！"})}).catch(function(e){t.loading=!1,t.$message({type:"error",message:"数据加载失败！"})})},deleteDocs:function(e){var t=this;ue("/anounce/delete",e).then(function(e){t.loading=!1,200==e.status?(1e3===e.data.code?(t.$message({type:"success",message:e.data.msg}),window.bus.$emit("analysis_list")):t.$message({type:"error",message:e.data.msg}),t.deleteData.length=0):t.$message({type:"error",message:"删除失败！"})},function(e){t.loading=!1,403==e.response.status?t.$alert("无权限进行删除操作","权限不足",{confirmButtonText:"确定",type:"warning"}):t.$message({type:"error",message:"删除失败！"})})}}},O={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"main_div"},[a("div",{staticClass:"search_div",staticStyle:{display:"flex","justify-content":"flex-start"}},[a("el-form",{ref:"form",staticClass:"report_form",attrs:{inline:"",model:e.form,"label-width":"80px","label-position":e.labelPosition,size:"mini"}},[a("el-col",{attrs:{md:12,lg:6}},[a("el-form-item",{attrs:{label:"文档编号"}},[a("el-input",{model:{value:e.form.fileNo,callback:function(t){e.$set(e.form,"fileNo",t)},expression:"form.fileNo"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:6}},[a("el-form-item",{attrs:{label:"文档名称"}},[a("el-input",{model:{value:e.form.fileName,callback:function(t){e.$set(e.form,"fileName",t)},expression:"form.fileName"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:6}},[a("el-form-item",{attrs:{label:"编制单位"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择科室"},model:{value:e.form.editOffice,callback:function(t){e.$set(e.form,"editOffice",t)},expression:"form.editOffice"}},e._l(e.offices,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:6}},[a("el-form-item",{attrs:{label:"编制人"}},[a("el-input",{model:{value:e.form.editPerson,callback:function(t){e.$set(e.form,"editPerson",t)},expression:"form.editPerson"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:6}},[a("el-form-item",{attrs:{label:"文档类型"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择文档类型"},model:{value:e.form.fileType,callback:function(t){e.$set(e.form,"fileType",t)},expression:"form.fileType"}},[a("el-option",{attrs:{label:"分析报告",value:"分析报告"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:6}},[a("el-form-item",{attrs:{label:"下发日期"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"month",placeholder:"选择日期","value-format":"yyyy-MM"},model:{value:e.form.issueDate,callback:function(t){e.$set(e.form,"issueDate",t)},expression:"form.issueDate"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:6}},[a("el-form-item",{staticClass:"new_check",attrs:{label:"最新版"}},[a("el-checkbox-group",{attrs:{max:1},model:{value:e.form.newVersion,callback:function(t){e.$set(e.form,"newVersion",t)},expression:"form.newVersion"}},[a("el-checkbox",{attrs:{label:"是"}}),e._v(" "),a("el-checkbox",{attrs:{label:"否"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:6}},[a("el-form-item",{attrs:{label:" "}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini",round:""},on:{click:e.onSubmit}},[e._v("查询")])],1)],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.list,"max-height":"470","tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[e.$_has("deletePerm")?a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}):e._e(),e._v(" "),a("el-table-column",{attrs:{label:"文档编号",fixed:"",width:"250",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.fileNo))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"文档名称",width:"300",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.fileName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"文档类型",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.fileType))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"编制人",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.editPerson))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"编制单位",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.editOffice))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"下发日期",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.issueDate))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"状态",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.status))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"职能",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.major))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"版块",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.category))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"工作项",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.plate))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right",align:"center",width:"180",height:"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.$_has("editPerm")||t.row.editPerson===e.currentUser.username?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"修改",placement:"top"}},[a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit",round:""},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}})],1):e._e(),e._v(" "),a("el-tooltip",{directives:[{name:"has",rawName:"v-has",value:"deletePerm",expression:"'deletePerm'"}],staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[a("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete",round:""},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"下载",placement:"top"}},[a("el-button",{attrs:{size:"mini",type:"success",icon:"el-icon-download",round:""},on:{click:function(a){return e.handleDownload(t.$index,t.row)}}})],1)]}}])})],1)],1),e._v(" "),a("div",{staticClass:"analysis_list_footer"},[a("el-button",{directives:[{name:"has",rawName:"v-has",value:"deletePerm",expression:"'deletePerm'"},{name:"show",rawName:"v-show",value:this.list.length>0,expression:"this.list.length>0 "}],staticStyle:{margin:"0px"},attrs:{type:"danger",size:"mini",disabled:0==this.selItems.length},on:{click:e.deleteMany}},[e._v("批量删除\n\t      ")]),e._v(" "),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:this.list.length>0,expression:"this.list.length>0"}],attrs:{"current-page":e.currentPageNum,"page-size":e.pageSize,layout:"total,prev, pager, next, jumper",total:e.totalCount},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPageNum=t},"update:current-page":function(t){e.currentPageNum=t}}})],1)])},staticRenderFns:[]};var F={data:function(){return{form:{fileNo:"",fileName:"",editOffice:"",editPerson:"",fileType:"培训资料",issueDate:"",major:"",plate:"",status:"受控",newVersion:[]},labelPosition:"left",list:[],selItems:[],loading:!1,currentPageNum:1,totalCount:-1,pageSize:10,hasConditions:!1,deleteData:[],offices:[],currentUser:"",tab:"train"}},beforeDestroy:function(){window.bus.$off("train_list")},mounted:function(){this.currentUser=JSON.parse(m("currentUser")),this.loadOffices();this.loading=!0;var e={fileNo:this.form.fileNo,fileName:this.form.fileName,editOffice:this.form.editOffice,editPerson:this.form.editPerson,fileType:this.form.fileType,issueDate:this.form.issueDate,major:this.form.major,plate:this.form.plate,status:this.form.status,tab:this.tab,currentPageNum:this.currentPageNum,pageSize:this.pageSize};this.loadList(e);var t=this;window.bus.$on("train_list",function(){t.loading=!0;var e={fileNo:t.form.fileNo,fileName:t.form.fileName,editOffice:t.form.editOffice,editPerson:t.form.editPerson,fileType:t.form.fileType,issueDate:t.form.issueDate,major:t.form.major,plate:t.form.plate,status:t.form.status,tab:t.tab,currentPageNum:t.currentPageNum,pageSize:t.pageSize};null==e.issueDate&&(e.issueDate=""),t.loadList(e)})},methods:{onSubmit:function(){this.loading=!0;var e={fileNo:this.form.fileNo,fileName:this.form.fileName,editOffice:this.form.editOffice,editPerson:this.form.editPerson,fileType:this.form.fileType,issueDate:this.form.issueDate,major:this.form.major,plate:this.form.plate,status:this.form.status,tab:this.tab,currentPageNum:this.currentPageNum,pageSize:this.pageSize};null==e.issueDate&&(e.issueDate=""),this.loadList(e)},deleteMany:function(){var e=this;this.$confirm("此操作将会删除该文件，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){for(var t=e.selItems,a=0;a<t.length;a++)e.deleteData.push(t[a].id);var l={aids:e.deleteData};e.deleteDocs(l)}).catch(function(){})},handleCurrentChange:function(e){this.currentPageNum=e,this.loading=!0;var t={fileNo:this.form.fileNo,fileName:this.form.fileName,editOffice:this.form.editOffice,editPerson:this.form.editPerson,fileType:this.form.fileType,issueDate:this.form.issueDate,major:this.form.major,plate:this.form.plate,status:this.form.status,tab:this.tab,currentPageNum:this.currentPageNum,pageSize:this.pageSize};null==t.issueDate&&(t.issueDate=""),this.loadList(t)},handleSelectionChange:function(e){this.selItems=e},handleEdit:function(e,t){this.$router.push({name:"上传文档",params:{row:t,flag:!0,changeVersion:!1,isReload:!1}})},handleDelete:function(e,t){var a=this;this.$confirm("此操作将会删除该文件，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.deleteData.length=0,a.deleteData.push(t.id);var e={aids:a.deleteData};a.deleteDocs(e)}).catch(function(){})},handleDownload:function(e,t){var a=this,l={filePath:t.filePath};fe("/anounce/download",l).then(function(e){if(200==e.status){if(0==e.data.size)return void a.$message({type:"error",message:"不存在该文档"});var t=window.URL.createObjectURL(new Blob([e.data])),s=document.createElement("a");s.style.display="none",s.href=t;var i=l.filePath,o=i.lastIndexOf("\\");s.setAttribute("download",i.substring(o,i.length)),document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(s.href),a.$message({type:"success",message:"正在下载！"})}else a.$message({type:"error",message:"下载失败"})})},loadOffices:function(){var e=this;de("/office/all",null).then(function(t){200==t.status?(e.offices=t.data.data,null!=e.list&&(e.list=u(e.list,e.offices))):e.$message({type:"error",message:"科室目录加载失败！"})},function(t){e.$message({type:"error",message:"科室目录加载失败！"})})},loadList:function(e){var t=this;ue("/anounce/all",e).then(function(e){t.loading=!1,200==e.status?(t.list=e.data.data.records,null!=t.offices&&(t.list=u(e.data.data.records,t.offices)),t.totalCount=e.data.data.totalCount):t.$message({type:"error",message:"数据加载失败！"})},function(e){t.loading=!1,403==e.response.status?t.$message({type:"error",message:e.response.data}):t.$message({type:"error",message:"数据加载失败！"})}).catch(function(e){t.loading=!1,t.$message({type:"error",message:"数据加载失败！"})})},deleteDocs:function(e){var t=this;ue("/anounce/delete",e).then(function(e){t.loading=!1,200==e.status?(1e3===e.data.code?(t.$message({type:"success",message:"删除成功！"}),window.bus.$emit("train_list")):t.$message({type:"error",message:"删除失败！"}),t.deleteData.length=0):t.$message({type:"error",message:"删除失败！"})},function(e){t.loading=!1,403==e.response.status?t.$alert("无权限进行删除操作","权限不足",{confirmButtonText:"确定",type:"warning"}):t.$message({type:"error",message:"删除失败！"})})}},props:["activeName"]},T={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"main_div"},[a("div",{staticClass:"search_div",staticStyle:{display:"flex","justify-content":"flex-start"}},[a("el-form",{ref:"form",staticClass:"other_form",attrs:{inline:"",model:e.form,"label-width":"80px","label-position":e.labelPosition,size:"mini"}},[a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"文档编号"}},[a("el-input",{model:{value:e.form.fileNo,callback:function(t){e.$set(e.form,"fileNo",t)},expression:"form.fileNo"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"文档名称"}},[a("el-input",{model:{value:e.form.fileName,callback:function(t){e.$set(e.form,"fileName",t)},expression:"form.fileName"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"编制单位"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择科室"},model:{value:e.form.editOffice,callback:function(t){e.$set(e.form,"editOffice",t)},expression:"form.editOffice"}},e._l(e.offices,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"编制人"}},[a("el-input",{model:{value:e.form.editPerson,callback:function(t){e.$set(e.form,"editPerson",t)},expression:"form.editPerson"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"职能"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择职能"},model:{value:e.form.major,callback:function(t){e.$set(e.form,"major",t)},expression:"form.major"}},[a("el-option",{attrs:{label:"质量类",value:"质量类"}}),e._v(" "),a("el-option",{attrs:{label:"体系类",value:"体系类"}}),e._v(" "),a("el-option",{attrs:{label:"综合类",value:"综合类"}}),e._v(" "),a("el-option",{attrs:{label:"项目管理",value:"项目管理"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"下发日期"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"month",placeholder:"选择日期","value-format":"yyyy-MM"},model:{value:e.form.issueDate,callback:function(t){e.$set(e.form,"issueDate",t)},expression:"form.issueDate"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"受控状态"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择状态"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[a("el-option",{attrs:{label:"受控",value:"受控"}}),e._v(" "),a("el-option",{attrs:{label:"过期报废",value:"过期报废"}}),e._v(" "),a("el-option",{attrs:{label:"替代报废",value:"替代报废"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"版块"}},[a("el-select",{staticStyle:{width:"60%"},attrs:{clearable:"",placeholder:"请选择版块"},model:{value:e.form.plate,callback:function(t){e.$set(e.form,"plate",t)},expression:"form.plate"}},[a("el-option",{attrs:{label:"电气",value:"电气"}}),e._v(" "),a("el-option",{attrs:{label:"结构",value:"结构"}}),e._v(" "),a("el-option",{attrs:{label:"系统",value:"系统"}}),e._v(" "),a("el-option",{attrs:{label:"整机",value:"整机"}}),e._v(" "),a("el-option",{attrs:{label:"图文",value:"图文"}}),e._v(" "),a("el-option",{attrs:{label:"体系类",value:"体系类"}}),e._v(" "),a("el-option",{attrs:{label:"调度类",value:"调度类"}}),e._v(" "),a("el-option",{attrs:{label:"综合类",value:"综合类"}}),e._v(" "),a("el-option",{attrs:{label:"包装策划",value:"包装策划"}}),e._v(" "),a("el-option",{attrs:{label:"产品成本",value:"产品成本"}}),e._v(" "),a("el-option",{attrs:{label:"成本管理",value:"成本管理"}}),e._v(" "),a("el-option",{attrs:{label:"外购样机",value:"外购样机"}}),e._v(" "),a("el-option",{attrs:{label:"控制器软件",value:"控制器软件"}}),e._v(" "),a("el-option",{attrs:{label:"控制器硬件",value:"控制器硬件"}})],1),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini",round:""},on:{click:e.onSubmit}},[e._v("查询")])],1)],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.list,"max-height":"470","tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[e.$_has("deletePerm")?a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}):e._e(),e._v(" "),a("el-table-column",{attrs:{label:"文档编号",fixed:"",width:"250",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.fileNo))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"文档名称",width:"300",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.fileName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"文档类型",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.fileType))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"编制人",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.editPerson))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"编制单位",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.editOffice))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"下发日期",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.issueDate))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"状态",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.status))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"职能",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.major))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"版块",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.category))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"工作项",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.plate))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right",align:"center",width:"180",height:"100%"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.$_has("editPerm")||t.row.editPerson===e.currentUser.username?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"修改",placement:"top"}},[a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit",round:""},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}})],1):e._e(),e._v(" "),a("el-tooltip",{directives:[{name:"has",rawName:"v-has",value:"deletePerm",expression:"'deletePerm'"}],staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[a("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete",round:""},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}})],1),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"下载",placement:"top"}},[a("el-button",{attrs:{size:"mini",type:"success",icon:"el-icon-download",round:""},on:{click:function(a){return e.handleDownload(t.$index,t.row)}}})],1)]}}])})],1)],1),e._v(" "),a("div",{staticClass:"task_list_footer"},[a("el-button",{directives:[{name:"has",rawName:"v-has",value:"deletePerm",expression:"'deletePerm'"},{name:"show",rawName:"v-show",value:this.list.length>0,expression:"this.list.length>0 "}],staticStyle:{margin:"0px"},attrs:{type:"danger",size:"mini",disabled:0==this.selItems.length},on:{click:e.deleteMany}},[e._v("批量删除\n\t      ")]),e._v(" "),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:this.list.length>0,expression:"this.list.length>0"}],attrs:{"current-page":e.currentPageNum,"page-size":e.pageSize,layout:"total,prev, pager, next, jumper",total:e.totalCount},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPageNum=t},"update:current-page":function(t){e.currentPageNum=t}}})],1)])},staticRenderFns:[]};var z={data:function(){return{activeName:"manage"}},mounted:function(){},methods:{handleClick:function(e,t){}},components:{"manage-list":a("VU/8")(_,y,!1,function(e){a("i0DN")},null,null).exports,"table-list":a("VU/8")(w,k,!1,function(e){a("x9Iy")},null,null).exports,"redtape-list":a("VU/8")($,N,!1,function(e){a("rzs2")},null,null).exports,"task-list":a("VU/8")(S,x,!1,function(e){a("ejqp")},null,null).exports,"work-list":a("VU/8")(P,D,!1,function(e){a("yPGt")},null,null).exports,"analysis-list":a("VU/8")(C,O,!1,function(e){a("wFO6")},null,null).exports,"train-list":a("VU/8")(F,T,!1,function(e){a("B8GT")},null,null).exports}},U={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{staticClass:"file_list"},[a("el-main",{staticClass:"main"},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"管理/技术标准/执行通知",name:"manage"}},[a("manage-list")],1),e._v(" "),a("el-tab-pane",{attrs:{label:"常用表格/模板",name:"table"}},[a("table-list")],1),e._v(" "),a("el-tab-pane",{attrs:{label:"红头文件/通报",name:"redtape"}},[a("redtape-list")],1),e._v(" "),a("el-tab-pane",{attrs:{label:"任务单",name:"task"}},[a("task-list")],1),e._v(" "),a("el-tab-pane",{attrs:{label:"作业指导书",name:"work"}},[a("work-list")],1),e._v(" "),a("el-tab-pane",{attrs:{label:"分析报告",name:"analysis"}},[a("analysis-list")],1),e._v(" "),a("el-tab-pane",{attrs:{label:"培训资料",name:"train"}},[a("train-list")],1)],1)],1)],1)},staticRenderFns:[]};var j=a("VU/8")(z,U,!1,function(e){a("fi3o")},null,null).exports,R=a("zL8q"),L=a.n(R),M={data:function(){return{form:{id:0,fileNo:"",oldFileNo:"",file:null,fileName:"",editOffice:"",editPerson:"",fileType:"",issueDate:"",major:"",plate:"",status:"受控",note:"",pdmNo:"",authorization:[]},rules:{fileNo:[{required:!0,message:"请输入文档编号",trigger:"blur"}],fileName:[{required:!0,message:"请输入文档名称",trigger:"blur"}],editOffice:[{required:!0,message:"请选择编制单位",trigger:"blur"}],editPerson:[{required:!0,message:"请输入编制人",trigger:"blur"}],fileType:[{required:!0,message:"请选择文档类型",trigger:"blur"}],issueDate:[{required:!0,message:"请选择下发日期",trigger:"blur"}]},labelPosition:"right",filelist:[],flag:!1,changeVersion:!0,offices:[],currentUser:"",isReloadBak:!0,checkAll:!1,isIndeterminate:!0}},mounted:function(){this.form.issueDate=this.getNowFormatDay(),this.currentUser=JSON.parse(m("currentUser")),this.loadOffices(),void 0!==this.$route.params.isReload&&(this.isReloadBak=this.$route.params.isReload),this.isReloadBak||this.isReload||(void 0!=this.$route.params.changeVersion&&(this.changeVersion=this.$route.params.changeVersion),this.flag=this.$route.params.flag,this.flag&&(this.form=JSON.parse(n()(this.$route.params.row))))},methods:{handleChange:function(e){console.log(e),this.filelist=[],this.form.file=e.raw,this.filelist.push({name:e.name,url:""});var t=e.name.substring(0,e.name.lastIndexOf("."));this.form.fileName=t},handChangeVersion:function(){this.changeVersion=!0},onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){return e?null==t.form.file&&1==t.changeVersion?(t.$notify.error({title:"表单错误",message:"请选择文件!"}),!1):void t.handleSubmit():(t.$notify.error({title:"表单错误",message:"红色星号标记项必须填写!"}),!1)})},handleSubmit:function(){1==this.form.authorization.length&&""==this.form.authorization[0]?this.form.authorization[0]=this.currentUser.office:this.form.authorization=this.nameToId(this.form.authorization);var e=new FormData;e.append("id",this.form.id),e.append("fileNo",this.form.fileNo),e.append("oldFileNo",this.form.oldFileNo),e.append("file",this.form.file),e.append("fileName",this.form.fileName),e.append("editOffice",this.form.editOffice),e.append("editPerson",this.form.editPerson),e.append("fileType",this.form.fileType),e.append("issueDate",this.form.issueDate),e.append("major",this.form.major),e.append("plate",this.form.plate),e.append("status",this.form.status),e.append("pdmNo",this.form.pdmNo),e.append("note",this.form.note),e.append("authorization",this.form.authorization);var t={id:this.form.id,fileNo:this.form.fileNo,oldFileNo:this.form.oldFileNo,fileName:this.form.fileName,editOffice:this.form.editOffice,editPerson:this.form.editPerson,fileType:this.form.fileType,issueDate:this.form.issueDate,major:this.form.major,plate:this.form.plate,status:this.form.status,pdmNo:this.form.pdmNo,note:this.form.note,authorization:this.form.authorization};null==this.form.file&&0==this.changeVersion&&this.updateAnounce(t),null!=this.form.file&&this.uploadFile(e)},loadOffices:function(){var e=this;de("/office/all",null).then(function(t){if(200==t.status)if(e.offices=t.data.data,null!=e.form.authorization){var a=e.form.authorization.toString().split(",");e.form.authorization=e.idToName(a)}else e.form.authorization=[];else e.$message({type:"error",message:"科室目录加载失败！"})},function(t){e.$message({type:"error",message:"科室目录加载失败！"})})},uploadFile:function(e){var t=this,a=this;this.form.file.size/1024/1024>30?a.$alert("文件大小超过30M,不能上传!","失败"):ce("/anounce/insert",e).then(function(l){if(200==l.status)if(1e3==l.data.code){a.$message({type:"success",message:l.data.data});var s="";"管理规定,管理标准,技术标准,体系规范,通知".indexOf(e.get("fileType"))>-1?s="manage_list":"综合类,管理类,专业类,模板".indexOf(e.get("fileType"))>-1?s="table_list":"红头文件,体系通报,表扬通报,质量黑榜,内部通报,职能通报,其他".indexOf(e.get("fileType"))>-1?s="redtape_list":"任务单".indexOf(e.get("fileType"))>-1?s="task_list":"作业指导书".indexOf(e.get("fileType"))>-1?s="work_list":"分析报告".indexOf(e.get("fileType"))>-1?s="analysis_list":"培训资料".indexOf(e.get("fileType"))>-1&&(s="train_list"),window.bus.$emit(s),t.$router.push("/fileList")}else a.$message({type:"error",message:l.data.data});else a.$message({type:"error",message:l.data.msg})})},updateAnounce:function(e){var t=this,a=this;ue("/anounce/update",e).then(function(l){if(200==l.status)if(1e3==l.data.code){a.$message({type:"success",message:"更新成功！"});var s="";["管理规定","管理标准","技术标准","体系规范","执行通知"].indexOf(e.fileType)>-1?s="manage_list":["综合类","管理类","专业类","模板"].indexOf(e.fileType)>-1?s="table_list":["红头文件","体系通报","表扬通报","质量黑榜","内部通报","职能通报","其他"].indexOf(e.fileType)>-1?s="redtape_list":["任务单"].indexOf(e.fileType)>-1?s="task_list":["作业指导书"].indexOf(e.fileType)>-1?s="work_list":["分析报告"].indexOf(e.fileType)>-1?s="analysis_list":["培训资料"].indexOf(e.fileType)>-1&&(s="train_list"),window.bus.$emit(s),t.$router.push("/fileList")}else a.$message({type:"error",message:l.data.data});else a.$message({type:"error",message:"更新失败"})})},defaultOffice:function(){var e=this,t="/office/"+this.form.editPerson;""!==this.form.editPerson&&de(t).then(function(t){200==t.status&&(e.form.editOffice=Number(t.data.data))})},getNowFormatDay:function(e){null==e&&(e=new Date);var t=e.getDate(),a=e.getMonth()+1;return e.getFullYear()+"-"+this.completeDate(a)+"-"+this.completeDate(t)},completeDate:function(e){return e<10?"0"+e:e},idToName:function(e){if(null!=e&&e.length>0){for(var t=0;t<e.length;t++)for(var a=0;a<this.offices.length;a++)if(e[t]==this.offices[a].id){e[t]=this.offices[a].name;break}}else e=[];return e},nameToId:function(e){if(null!=e&&e.length>0)for(var t=0;t<e.length;t++)for(var a=0;a<this.offices.length;a++)if(e[t]==this.offices[a].name){e[t]=this.offices[a].id;break}return e},handleCheckAllChange:function(e){console.log("handleCheckAllChange");for(var t=[],a=0;a<this.offices.length;a++)t[a]=this.offices[a].name;this.form.authorization=e?t:[],this.isIndeterminate=!1},handleCheckedOfficesChange:function(e){var t=e.length;this.checkAll=t===this.offices.length,this.isIndeterminate=t>0&&t<this.offices.length}},props:["isReload"]},I={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"upload_div",staticStyle:{display:"flex","justify-content":"flex-start"}},[a("el-form",{ref:"form",staticClass:"upload-form",attrs:{model:e.form,rules:e.rules,"label-width":"80px","label-position":e.labelPosition,size:"mini"}},[a("el-form-item",{attrs:{label:"文档编号",prop:"fileNo"}},[a("el-input",{model:{value:e.form.fileNo,callback:function(t){e.$set(e.form,"fileNo",t)},expression:"form.fileNo"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"旧版编号"}},[a("el-input",{model:{value:e.form.oldFileNo,callback:function(t){e.$set(e.form,"oldFileNo",t)},expression:"form.oldFileNo"}})],1),e._v(" "),a("el-form-item",{attrs:{label:""}},[e.changeVersion?e._e():a("el-button",{attrs:{type:"primary",round:""},on:{click:e.handChangeVersion}},[e._v("换版")])],1),e._v(" "),a("div",{staticClass:"upload-file"},[e.changeVersion?a("el-form-item",{attrs:{label:"上传文件"}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"",limit:1,"on-change":e.handleChange,"file-list":e.filelist,"auto-upload":!1}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件")])],1)],1):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"授权给"}},[a("el-popover",{attrs:{placement:"bottom",title:"科室列表",width:"200",trigger:"click"}},[a("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")]),e._v(" "),a("el-checkbox-group",{on:{change:e.handleCheckedOfficesChange},model:{value:e.form.authorization,callback:function(t){e.$set(e.form,"authorization",t)},expression:"form.authorization"}},e._l(e.offices,function(e,t){return a("el-checkbox",{key:t,attrs:{label:e.name}})}),1),e._v(" "),a("el-button",{staticStyle:{"padding-top":"0px"},attrs:{slot:"reference",type:"text",icon:"el-icon-more"},slot:"reference"})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"文档名称",prop:"fileName"}},[a("el-input",{model:{value:e.form.fileName,callback:function(t){e.$set(e.form,"fileName",t)},expression:"form.fileName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"编制人",prop:"editPerson"}},[a("el-input",{on:{blur:e.defaultOffice},model:{value:e.form.editPerson,callback:function(t){e.$set(e.form,"editPerson",t)},expression:"form.editPerson"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"编制单位",prop:"editOffice"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择科室"},model:{value:e.form.editOffice,callback:function(t){e.$set(e.form,"editOffice",t)},expression:"form.editOffice"}},e._l(e.offices,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"文档类型",prop:"fileType"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择文档类型"},model:{value:e.form.fileType,callback:function(t){e.$set(e.form,"fileType",t)},expression:"form.fileType"}},[a("el-option",{attrs:{label:"表扬通报",value:"表扬通报"}}),e._v(" "),a("el-option",{attrs:{label:"管理规定",value:"管理规定"}}),e._v(" "),a("el-option",{attrs:{label:"管理标准",value:"管理标准"}}),e._v(" "),a("el-option",{attrs:{label:"红头文件",value:"红头文件"}}),e._v(" "),a("el-option",{attrs:{label:"技术标准",value:"技术标准"}}),e._v(" "),a("el-option",{attrs:{label:"内部通报",value:"内部通报"}}),e._v(" "),a("el-option",{attrs:{label:"体系通报",value:"体系通报"}}),e._v(" "),a("el-option",{attrs:{label:"质量黑榜",value:"质量黑榜"}}),e._v(" "),a("el-option",{attrs:{label:"体系规范",value:"体系规范"}}),e._v(" "),a("el-option",{attrs:{label:"职能通报",value:"职能通报"}}),e._v(" "),a("el-option",{attrs:{label:"作业指导书",value:"作业指导书"}}),e._v(" "),a("el-option",{attrs:{label:"任务单",value:"任务单"}}),e._v(" "),a("el-option",{attrs:{label:"综合类",value:"综合类"}}),e._v(" "),a("el-option",{attrs:{label:"管理类",value:"管理类"}}),e._v(" "),a("el-option",{attrs:{label:"专业类",value:"专业类"}}),e._v(" "),a("el-option",{attrs:{label:"分析报告",value:"分析报告"}}),e._v(" "),a("el-option",{attrs:{label:"培训资料",value:"培训资料"}}),e._v(" "),a("el-option",{attrs:{label:"模板",value:"模板"}}),e._v(" "),a("el-option",{attrs:{label:"通知",value:"通知"}}),e._v(" "),a("el-option",{attrs:{label:"其他",value:"其他"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"职能"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择职能"},model:{value:e.form.major,callback:function(t){e.$set(e.form,"major",t)},expression:"form.major"}},[a("el-option",{attrs:{label:"质量类",value:"质量类"}}),e._v(" "),a("el-option",{attrs:{label:"体系类",value:"体系类"}}),e._v(" "),a("el-option",{attrs:{label:"综合类",value:"综合类"}}),e._v(" "),a("el-option",{attrs:{label:"项目管理",value:"项目管理"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"下发日期",prop:"issueDate"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.form.issueDate,callback:function(t){e.$set(e.form,"issueDate",t)},expression:"form.issueDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"受控状态"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择状态"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[a("el-option",{attrs:{label:"受控",value:"受控"}}),e._v(" "),a("el-option",{attrs:{label:"过期报废",value:"过期报废"}}),e._v(" "),a("el-option",{attrs:{label:"替代报废",value:"替代报废"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"版块"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择版块"},model:{value:e.form.plate,callback:function(t){e.$set(e.form,"plate",t)},expression:"form.plate"}},[a("el-option",{attrs:{label:"电气",value:"电气"}}),e._v(" "),a("el-option",{attrs:{label:"结构",value:"结构"}}),e._v(" "),a("el-option",{attrs:{label:"系统",value:"系统"}}),e._v(" "),a("el-option",{attrs:{label:"整机",value:"整机"}}),e._v(" "),a("el-option",{attrs:{label:"图文",value:"图文"}}),e._v(" "),a("el-option",{attrs:{label:"体系类",value:"体系类"}}),e._v(" "),a("el-option",{attrs:{label:"调度类",value:"调度类"}}),e._v(" "),a("el-option",{attrs:{label:"综合类",value:"综合类"}}),e._v(" "),a("el-option",{attrs:{label:"包装策划",value:"包装策划"}}),e._v(" "),a("el-option",{attrs:{label:"产品成本",value:"产品成本"}}),e._v(" "),a("el-option",{attrs:{label:"成本管理",value:"成本管理"}}),e._v(" "),a("el-option",{attrs:{label:"外购样机",value:"外购样机"}}),e._v(" "),a("el-option",{attrs:{label:"控制器软件",value:"控制器软件"}}),e._v(" "),a("el-option",{attrs:{label:"控制器硬件",value:"控制器硬件"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"PDM编号"}},[a("el-input",{model:{value:e.form.pdmNo,callback:function(t){e.$set(e.form,"pdmNo",t)},expression:"form.pdmNo"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{model:{value:e.form.note,callback:function(t){e.$set(e.form,"note",t)},expression:"form.note"}})],1),e._v(" "),a("el-form-item",{attrs:{label:" "}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-thumb",size:"mini",round:""},on:{click:function(t){return e.onSubmit("form")}}},[e._v("提交")])],1)],1)],1)])},staticRenderFns:[]};var V=a("VU/8")(M,I,!1,function(e){a("Dup8")},null,null).exports,B=a("BO1k"),A=a.n(B),E={data:function(){return{loading:!1,currentPageNum:1,pageSize:6,totalCount:-1,dialogFormVisible:!1,searchForm:{username:"",mail:"",employeeId:"",office:""},userForm:{username:"",mail:"",employeeId:"",office:""},rules:{username:[{required:!0,message:"请输入员工姓名",trigger:"blur"}],employeeId:[{required:!0,message:"请输入员工编号",trigger:"blur"}],mail:[{required:!0,message:"请输入邮箱号",trigger:"blur"}],office:[{required:!0,message:"请选择科室",trigger:"blur"}]},users:[],allRoles:[],roles:[],rolesBak:[],currentUser:"",offices:[],role:"",currentOffice:""}},mounted:function(){this.loadOffices();window.screen.width>=1920?this.pageSize=10:this.pageSize=6,this.currentUser=JSON.parse(m("currentUser")),this.getRole(),this.firstLoadUserList()},methods:{saveUser:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return t.$message({type:"error",message:"请完整填写信息！！！"}),!1;var a=t;ue("/reg",t.userForm).then(function(e){200==e.status?1e3===e.data.code?(a.dialogFormVisible=!1,a.userForm.username="",a.userForm.mail="",a.userForm.employeeId="",a.userForm.office="",a.$message({type:"success",message:"注册成功！"}),a.firstLoadUserList()):a.$message({type:"error",message:e.data.data}):a.$message({type:"error",message:"提交失败"})},function(e){403==e.response.status?a.$message({type:"error",message:e.response.data}):a.$message({type:"error",message:"根本找不到服务器"})})})},onSubmit:function(){this.firstLoadUserList()},handleCurrentChange:function(e){this.currentPageNum=e,this.firstLoadUserList()},saveRoles:function(e,t){var a=[],l=!0,s=!1,i=void 0;try{for(var o,r=A()(this.roles);!(l=(o=r.next()).done);l=!0){var n=o.value;a.push(n)}}catch(e){s=!0,i=e}finally{try{!l&&r.return&&r.return()}finally{if(s)throw i}}var u=this,c=[];console.log("selRoles:"+a);for(var f=0;f<this.rolesBak.length;f++)if(0!==a.length)for(var m=0;m<a.length;m++){if(this.rolesBak[f]==a[m]){a.splice(m,1);break}c.push(this.rolesBak[f]);break}else c.push(this.rolesBak[f]);if(a.length>0){ue("/role/add",{rids:a,uid:e}),0==c&&this.loadOneUserById(e,t)}if(c.length>0){ue("/role/delete",{rids:c,uid:e}).then(function(a){u.loadOneUserById(e,t)}),c=[]}},showRole:function(e,t){this.roles=[],this.rolesBak=[],this.loadRoles();for(var a=0;a<e.length;a++)4!=e[a].id&&(this.roles.push(e[a].id),this.rolesBak.push(e[a].id))},deleteUser:function(e){var t=this;this.$confirm("此操作将会删除该用户，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){de("/user/delete/"+e).then(function(e){200==e.status&&(1e3===e.data.code?(t.$message({type:"success",message:"删除成功"}),t.firstLoadUserList()):t.$message({type:"error",message:"删除失败"}))})})},enabledChange:function(e,t,a,l){var s=this;ue("/user/enabled",{id:a,enabled:t}).then(function(e){200==e.status?(s.$message({type:"success",message:"更新成功"}),s.loadOneUserById(a,l)):s.$message({type:"success",message:"更新失败"})},function(e){})},loadOffices:function(){var e=this;de("/office/all",null).then(function(t){if(200==t.status){e.offices=t.data.data,null!=e.users&&(e.users=c(e.users,e.offices));var a=[{office:e.currentUser.office}];e.currentOffice=c(a,e.offices)[0].office}else e.$message({type:"error",message:"科室目录加载失败！"})},function(t){e.$message({type:"error",message:"科室目录加载失败！"})})},loadRoles:function(){var e=this;de("/role/list").then(function(t){200==t.status?e.allRoles=t.data.data:e.$message({type:"error",message:"角色列表加载失败"})},function(t){e.$message({type:"error",message:"角色列表加载失败"})})},loadOneUserById:function(e,t){var a=this;de("/user/"+e).then(function(e){200==e.status?a.users.splice(t,1,e.data.data):a.$message({type:"error",message:"加载失败"})})},loadUserList:function(e){var t=this;ue("/user/list",e).then(function(e){200==e.status?(t.users=e.data.data.records,null==t.users?(t.users=[],t.$message({type:"success",message:"暂无数据"})):null!=t.offices&&(t.users=c(e.data.data.records,t.offices)),t.totalCount=e.data.data.totalCount):t.$message({type:"error",message:"数据加载失败"})})},firstLoadUserList:function(){var e={username:this.searchForm.username,mail:this.searchForm.mail,employeeId:this.searchForm.employeeId,office:this.searchForm.office,currentPageNum:this.currentPageNum,pageSize:this.pageSize};"科室主任"===this.currentUser.roles[0].name&&(e.office=this.currentUser.office),this.loadUserList(e)},getRole:function(){for(var e=this.currentUser.roles,t=0;t<e.length;t++)if("超级管理员"===e[t].name||"公司领导"===e[t].name||"部门领导"===e[t].name||"科室主任"===e[t].name){this.role=e[t].name;break}},isDisabled:function(e){for(var t=!1,a=0;a<e.length;a++){if("超级管理员"===this.role&&"超级管理员"===e[a].name){t=!0;break}if("公司领导"===this.role&&("公司领导"===e[a].name||"超级管理员"===e[a].name)){t=!0;break}if("部门领导"===this.role&&("部门领导"===e[a].name||"超级管理员"===e[a].name||"公司领导"===e[a].name)){t=!0;break}if("科室主任"===this.role&&("科室主任"===e[a].name||"超级管理员"===e[a].name||"公司领导"===e[a].name||"部门领导"===e[a].name)){t=!0;break}}return t},isDisabled_item:function(e){var t=!1;return"超级管理员"===this.role&&"超级管理员"===e.name&&(t=!0),"公司领导"===this.role&&("公司领导"!==e.name&&"超级管理员"!==e.name||(t=!0)),"部门领导"===this.role&&("部门领导"!==e.name&&"超级管理员"!==e.name&&"公司领导"!==e.name||(t=!0)),"科室主任"===this.role&&("科室主任"!==e.name&&"超级管理员"!==e.name&&"公司领导"!==e.name&&"部门领导"!==e.name||(t=!0)),t},formatDate:function(e){return null!=e&&""!=e?(e=new Date(e)).getFullYear()+"-"+((e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-")+(e.getDate()<10?"0"+e.getDate():e.getDate()):""}}},q={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"search_div",staticStyle:{display:"-webkit-flex","justify-content":"flex-start"}},[a("el-form",{ref:"form",staticClass:"search_form",attrs:{inline:"",model:e.searchForm,"label-width":"80px",size:"mini"}},[a("el-col",{attrs:{md:8,lg:6,xl:5}},[a("el-form-item",{attrs:{label:"姓名"}},[a("el-input",{model:{value:e.searchForm.username,callback:function(t){e.$set(e.searchForm,"username",t)},expression:"searchForm.username"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:8,lg:6,xl:5}},[a("el-form-item",{attrs:{label:"邮箱"}},[a("el-input",{model:{value:e.searchForm.mail,callback:function(t){e.$set(e.searchForm,"mail",t)},expression:"searchForm.mail"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:8,lg:6,xl:5}},[a("el-form-item",{attrs:{label:"员工编号"}},[a("el-input",{model:{value:e.searchForm.employeeId,callback:function(t){e.$set(e.searchForm,"employeeId",t)},expression:"searchForm.employeeId"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:8,lg:6,xl:5}},[a("el-form-item",{attrs:{label:"科室"}},["科室主任"!==e.role?a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择科室"},model:{value:e.searchForm.office,callback:function(t){e.$set(e.searchForm,"office",t)},expression:"searchForm.office"}},e._l(e.offices,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1):a("el-select",{attrs:{placeholder:"请选择科室"},model:{value:e.userForm.office,callback:function(t){e.$set(e.userForm,"office",t)},expression:"userForm.office"}},[a("el-option",{attrs:{label:e.currentOffice,value:e.currentUser.office}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{md:8,lg:12,xl:2}},[a("el-form-item",{attrs:{label:""}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini",round:""},on:{click:e.onSubmit}},[e._v("查询")])],1)],1),e._v(" "),a("el-col",{attrs:{md:8,lg:12,xl:2}},[a("el-form-item",{attrs:{label:""}},[a("el-button",{attrs:{type:"success",icon:"el-icon-plus",size:"mini",round:""},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("添加")])],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"添加用户",visible:e.dialogFormVisible,center:""},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"userForm",attrs:{model:e.userForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"员工姓名","label-width":"80px",prop:"username"}},[a("el-input",{model:{value:e.userForm.username,callback:function(t){e.$set(e.userForm,"username",t)},expression:"userForm.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"员工编号","label-width":"80px",prop:"employeeId"}},[a("el-input",{model:{value:e.userForm.employeeId,callback:function(t){e.$set(e.userForm,"employeeId",t)},expression:"userForm.employeeId"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"员工邮箱","label-width":"80px",prop:"mail"}},[a("el-input",{model:{value:e.userForm.mail,callback:function(t){e.$set(e.userForm,"mail",t)},expression:"userForm.mail"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"科室","label-width":"80px",prop:"office"}},["科室主任"!==e.role?a("el-select",{attrs:{placeholder:"请选择科室"},model:{value:e.userForm.office,callback:function(t){e.$set(e.userForm,"office",t)},expression:"userForm.office"}},e._l(e.offices,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1):a("el-select",{attrs:{placeholder:"请选择科室"},model:{value:e.userForm.office,callback:function(t){e.$set(e.userForm,"office",t)},expression:"userForm.office"}},[a("el-option",{attrs:{label:e.currentOffice,value:e.currentUser.office}})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveUser("userForm")}}},[e._v("提交")])],1)],1)],1),e._v(" "),a("div",{staticStyle:{display:"flex","justify-content":"space-around","flex-wrap":"wrap"}},e._l(e.users,function(t,l){return a("el-card",{key:l,staticStyle:{width:"330px","margin-top":"10px"}},[a("div",[a("div",{staticStyle:{"text-align":"left"},attrs:{slot:"header"},slot:"header"},[a("span",[e._v(e._s(t.username))]),e._v(" "),e.isDisabled(t.roles)?e._e():a("el-button",{staticStyle:{float:"right",padding:"3px 0",color:"#ff0509"},attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.deleteUser(t.id)}}},[e._v("删除\n\t          ")])],1),e._v(" "),a("div",[a("div",{staticStyle:{"text-align":"left",color:"#20a0ff","font-size":"12px","margin-top":"13px"}},[a("span",[e._v("员工编号:")]),a("span",[e._v(e._s(t.employeeId))])]),e._v(" "),a("div",{staticStyle:{"text-align":"left",color:"#20a0ff","font-size":"12px","margin-top":"13px"}},[a("span",[e._v("邮箱:")]),a("span",[e._v(e._s(t.mail))])]),e._v(" "),a("div",{staticStyle:{"text-align":"left",color:"#20a0ff","font-size":"12px","margin-top":"13px"}},[a("span",[e._v("科室:")]),a("span",[e._v(e._s(t.office))])]),e._v(" "),a("div",{staticStyle:{"text-align":"left",color:"#20a0ff","font-size":"12px","margin-top":"13px"}},[a("span",[e._v("注册时间:")]),a("span",[e._v(e._s(e.formatDate(t.gmtCreate)))])]),e._v(" "),a("div",{staticStyle:{"text-align":"left",color:"#20a0ff","font-size":"12px","margin-top":"13px",display:"flex","align-items":"center"}},[a("span",[e._v("用户状态:")]),e._v(" "),a("el-switch",{staticStyle:{"font-size":"12px"},attrs:{"active-text":"启用","active-color":"#13ce66",disabled:e.isDisabled(t.roles),"inactive-text":"禁用"},on:{change:function(a){return e.enabledChange(t,t.enabled,t.id,l)}},model:{value:t.enabled,callback:function(a){e.$set(t,"enabled",a)},expression:"user.enabled"}})],1),e._v(" "),a("div",{staticStyle:{"text-align":"left",color:"#20a0ff","font-size":"12px","margin-top":"13px"}},[a("span",[e._v("用户角色:")]),e._v(" "),e._l(t.roles,function(t){return a("el-tag",{key:t.id,staticStyle:{"margin-right":"8px"},attrs:{size:"mini",type:"success"}},[e._v("\n\t              "+e._s(t.name)+"\n\t            ")])}),e._v(" "),a("el-popover",{key:l+""+t.id,attrs:{placement:"right",title:"角色列表",width:"200",trigger:"click"},on:{hide:function(a){return e.saveRoles(t.id,l)}}},[a("el-select",{key:t.id,attrs:{multiple:"",placeholder:"请选择",size:"mini"},model:{value:e.roles,callback:function(t){e.roles=t},expression:"roles"}},e._l(e.allRoles,function(l,s){return a("el-option",{key:t.id+"-"+l.id,attrs:{disabled:e.isDisabled_item(l),label:l.name,value:l.id}})}),1),e._v(" "),a("el-button",{staticStyle:{"padding-top":"0px"},attrs:{slot:"reference",type:"text",icon:"el-icon-more",disabled:e.isDisabled(t.roles)},on:{click:function(a){return e.showRole(t.roles,l)}},slot:"reference"})],1)],2)])])])}),1),e._v(" "),a("div",{staticClass:"page_footer"},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:this.users.length>0,expression:"this.users.length>0"}],attrs:{"current-page":e.currentPageNum,"page-size":e.pageSize,layout:"total,prev, pager, next, jumper",total:e.totalCount},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPageNum=t},"update:current-page":function(t){e.currentPageNum=t}}})],1)])},staticRenderFns:[]};var J=a("VU/8")(E,q,!1,function(e){a("pCpa")},null,null).exports,G={data:function(){return{fileList:[],loading:!0,topPath:"F:\\归类测试",path:"F:\\归类测试",isShowDiglog:!1,isShowRename:!1,isShowMkdir:!1,isShowMove:!1,uploadFile:[],uploadForm:{path:"",file:null},renameForm:{oldPath:"",newName:""},dirForm:{dirName:""},moveForm:{oldPaths:[],newPath:""},rules:{newName:[{required:!0,message:"文件新名称不能为空",trigger:"blur"}],dirName:[{required:!0,message:"新文件夹名称不能为空",trigger:"blur"}],newPath:[{required:!0,message:"目标路径不能为空",trigger:"blur"}]},selItems:[]}},mounted:function(){this.loadFiles(this.path)},methods:{loadFiles:function(e){var t=this;ue("/archive/fileList",{path:e}).then(function(a){200==a.status&&a.data.fileList&&(t.fileList=a.data.fileList,t.loading=!1,t.path=e)}).catch(function(e){})},handListFile:function(e){e.dir&&this.loadFiles(this.path+"\\"+e.fileName)},upDir:function(){var e=this.path.substring(0,this.path.lastIndexOf("\\"));this.loadFiles(e)},topDir:function(){this.loadFiles(this.topPath)},handleChange:function(e){this.uploadFile=[],this.uploadForm.file=e.raw,this.uploadFile.push({name:e.name,url:""})},saveUpload:function(e){var t=this;this.$refs[e].validate(function(e){if(e){if(null==t.uploadForm.file)return t.$notify.error({title:"表单错误",message:"请选择文件!"}),!1;var a=new FormData;a.append("path",t.path+"\\"+t.uploadForm.path),a.append("file",t.uploadForm.file);ce("/archive/upload",a).then(function(e){200==e.status&&"success"===e.data.status&&(t.uploadForm.path="",t.uploadForm.file=null,t.uploadFile=[],t.isShowDiglog=!1,t.loadFiles(t.path),t.$message({type:"success",message:e.data.msg}))})}})},cancel:function(e){console.log(this.$refs[e]),this.$refs[e].resetFields(),this.isShowDiglog=!1,this.isShowRename=!1,this.isShowMove=!1,this.isShowMkdir=!1},showRename:function(e,t){this.isShowRename=!0,this.renameForm.oldPath=this.path+"\\"+t.fileName,console.log(this.renameForm.oldPath)},saveRename:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return t.$notify.error({title:"表单错误",message:"红色星号标记项必须填写!"}),!1;ue("/archive/rename",t.renameForm).then(function(e){200==e.status&&"success"===e.data.status&&(t.renameForm.oldPath="",t.renameForm.newName="",t.isShowRename=!1,t.loadFiles(t.path),t.$message({type:"success",message:e.data.msg}))})})},cancelRename:function(){this.renameForm.oldPath="",this.renameForm.newName="",this.isShowRename=!1},handleDelte:function(e,t){var a=this;this.$confirm("此操作将会删除该文件，一旦删除就不能恢复，建议你重新检查一次选中的文件，或者使用重命名代替删除，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e={path:a.path+"\\"+t.fileName};ue("/archive/delete",e).then(function(e){200===e.status&&"success"===e.data.status&&(a.$message({type:"success",message:e.data.msg}),a.loadFiles(a.path))})}).catch(function(){})},handleDownload:function(e,t){var a=this,l={path:this.path+"\\"+t.fileName};fe("archive/download",l).then(function(e){if(200===e.status){if(0==e.data.size)return void a.$message({type:"error",message:"不存在该文档"});var l=window.URL.createObjectURL(new Blob([e.data])),s=document.createElement("a");s.style.display="nono",s.href=l,s.setAttribute("download",t.fileName),document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(l),a.$message({type:"success",message:"正在下载"})}else a.$message({type:"error",message:"下载失败"})},function(e){a.$message({type:"error",message:"服务器异常"})})},saveDir:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return t.$notify.error({title:"表单错误",message:"红色星号标记项必须填写!"}),!1;var a={path:t.path+"\\"+t.dirForm.dirName};ue("/archive/mkdirs",a).then(function(e){200==e.status&&("success"===e.data.status?(t.dirForm.dirName="",t.isShowMkdir=!1,t.loadFiles(t.path),t.$message({type:"success",message:e.data.msg})):t.$message({type:"error",message:e.data.msg}))})})},cancelDir:function(){this.dirForm.dirName="",this.isShowMkdir=!1},handleSelectionChange:function(e){this.selItems=e},saveMove:function(e){var t=this;console.log(this.topPath+this.moveForm.newPath),this.$refs[e].validate(function(e){if(!e)return t.$notify.error({title:"表单错误",message:"红色星号标记项必须填写!"}),!1;var a=t.selItems.length;if(a<1)return t.$message({type:"error",message:"请选择要移动的文件"}),void(t.isShowMove=!1);for(var l=0;l<a;l++)t.moveForm.oldPaths[l]=t.path+"\\"+t.selItems[l].fileName;var s={oldPaths:t.moveForm.oldPaths,newPath:t.topPath+t.moveForm.newPath};console.log(s),ue("/archive/move",s).then(function(e){200==e.status&&("success"===e.data.status?(t.selItems=[],t.moveForm.newPath="",t.moveForm.oldPaths=[],t.isShowMove=!1,t.$refs.multipleTable.clearSelection(),t.loadFiles(t.path),t.$message({type:"success",message:e.data.msg})):t.$message({type:"error",message:e.data.msg}))})})},cancelMove:function(){this.moveForm.oldPaths=[],this.moveForm.newPath="",this.$refs.multipleTable.clearSelection(),this.isShowMove=!1}}},H={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticStyle:{margin:"10px 0 10px 0"}},[a("span",{staticStyle:{"padding-right":"50px",color:"#909399"}},[e._v("当前路径:"+e._s(e.path.substring(e.path.indexOf("\\"))))]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.topDir}},[e._v("顶层")]),e._v(" "),e.topPath!==e.path?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.upDir}},[e._v("后退")]):e._e(),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.isShowDiglog=!0}}},[e._v("上传文件")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.isShowMkdir=!0}}},[e._v("创建文件夹")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.isShowMove=!0}}},[e._v("移动文件")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{border:"",data:e.fileList,"max-height":"600","tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{staticStyle:{width:"5%"},attrs:{type:"selection",align:"center"}}),e._v(" "),a("el-table-column",{staticStyle:{width:"10%"},attrs:{label:"文件类别",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.fileType))])]}}])}),e._v(" "),a("el-table-column",{staticStyle:{width:"40%"},attrs:{label:"文件名",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(a){return e.handListFile(t.row)}}},[t.row.dir?a("i",{staticClass:"el-icon-folder"}):a("i",{staticClass:"el-icon-document"}),e._v("\n\t\t    \t\t"+e._s(t.row.fileName)+"\n\t\t    \t")])]}}])}),e._v(" "),a("el-table-column",{staticStyle:{width:"15%"},attrs:{label:"文件大小",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.dir?a("span",[e._v("文件夹")]):a("span",[e._v(e._s(t.row.fileSize))])]}}])}),e._v(" "),a("el-table-column",{staticStyle:{width:"10%"},attrs:{label:"上传时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.uploadTime))])]}}])}),e._v(" "),a("el-table-column",{staticStyle:{width:"20%"},attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.showRename(t.$index,t.row)}}},[e._v("重命名")]),e._v(" "),t.row.dir?e._e():a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return e.handleDownload(t.$index,t.row)}}},[e._v("下载")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.handleDelte(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:"上传文件",visible:e.isShowDiglog,width:"50%",center:""},on:{"update:visible":function(t){e.isShowDiglog=t}}},[a("el-form",{ref:"uploadForm",attrs:{model:e.uploadForm}},[a("el-form-item",{attrs:{label:"文件归档到: (当前路径作为父目录，填入文件夹名;若归档到当前目录下无需填写)"}},[a("el-input",{model:{value:e.uploadForm.path,callback:function(t){e.$set(e.uploadForm,"path",t)},expression:"uploadForm.path"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上传文件"}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"",limit:1,"on-change":e.handleChange,"file-list":e.uploadFile,"auto-upload":!1}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件")])],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.cancel("uploadForm")}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveUpload("uploadForm")}}},[e._v("保存")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"重命名",visible:e.isShowRename,width:"50%",center:""},on:{"update:visible":function(t){e.isShowRename=t}}},[a("el-form",{ref:"renameForm",attrs:{model:e.renameForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"文件新名称: (不需要加后缀)",prop:"newName"}},[a("el-input",{model:{value:e.renameForm.newName,callback:function(t){e.$set(e.renameForm,"newName",t)},expression:"renameForm.newName"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.cancel("renameForm")}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveRename("renameForm")}}},[e._v("保存")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"创建文件夹",visible:e.isShowMkdir,width:"50%",center:""},on:{"update:visible":function(t){e.isShowMkdir=t}}},[a("el-form",{ref:"dirForm",attrs:{model:e.dirForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"新文件夹名称: (不要含有\\ / 双引号)",prop:"dirName"}},[a("el-input",{model:{value:e.dirForm.dirName,callback:function(t){e.$set(e.dirForm,"dirName",t)},expression:"dirForm.dirName"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.cancel("dirForm")}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveDir("dirForm")}}},[e._v("保存")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"移动文件",visible:e.isShowMove,width:"50%",center:""},on:{"update:visible":function(t){e.isShowMove=t}}},[a("el-form",{ref:"moveForm",attrs:{model:e.moveForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"输入目标路径: (如\\abc\\)",prop:"newPath"}},[a("el-input",{model:{value:e.moveForm.newPath,callback:function(t){e.$set(e.moveForm,"newPath",t)},expression:"moveForm.newPath"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.cancel("moveForm")}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveMove("moveForm")}}},[e._v("保存")])],1)],1)],1)},staticRenderFns:[]},Q=(a("VU/8")(G,H,!1,null,null,null).exports,a("fZjL")),W=a.n(Q),Y={data:function(){return{form:{temperatures:[]},rules:{temperatureAM:[{required:!0,message:"请输入上午温度",trigger:"blur"}],temperaturePM:[{required:!0,message:"请输入下午温度",trigger:"blur"}]},options:[{label:"正常",value:"正常"},{label:"上午请假",value:"上午请假"},{label:"下午请假",value:"下午请假"},{label:"请假一天",value:"请假一天"},{label:"通宵调休",value:"通宵调休"}],forenoon:1145,afternoon:1730,currentTime:0,isShow:!0,role:"",focus:1,offices:[]}},mounted:function(){this.currentUser=JSON.parse(m("currentUser")),this.loadOffices(),this.getRole(),this.getCurrentTime(),this.initForm()},methods:{getRole:function(){for(var e=0;e<this.currentUser.roles.length;e++)if("超级管理员"===this.currentUser.roles[e].name||"体温管理员"===this.currentUser.roles[e].name){this.role=this.currentUser.roles[e].name;break}},getCurrentTime:function(){var e=new Date,t=e.getHours(),a=e.getMinutes();a<10&&(a="0"+a),this.currentTime=t+""+a},onSumbit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return t.$notify.error({title:"表单错误",message:"必填项没有填写!"}),!1;t.save()})},resetForm:function(e){this.$refs[e].resetFields()},initForm:function(){var e=this;de("/temperature/initForm").then(function(t){200==t.status?(e.form.temperatures=c(t.data.data,e.offices),(e.currentTime>e.forenoon&&e.currentTime<1200||e.currentTime>e.afternoon)&&(e.isShow=!1),"体温管理员"!==e.role&&"超级管理员"!==e.role||(e.isShow=!0)):e.$message({type:"error",message:"初始化表单失败!"})}).catch(function(t){e.$message({type:"error",message:"服务器响应异常!"})})},nextFocus:function(e,t,a){a.target.blur(),"form"===W()(this.$refs)[t+1]&&(t=-1),this.$refs[W()(this.$refs)[t+1]].focus()},save:function(){var e=this,t="/temperature/insert";0!=this.form.temperatures[0].id&&(t="/temperature/update"),this.form.temperatures=function(e,t){for(var a=0;a<e.length;a++)for(var l=0;l<t.length;l++)if(e[a].office==t[l].name){e[a].office=t[l].id;break}return e}(this.form.temperatures,this.offices),me(t,this.form.temperatures).then(function(t){200==t.status?1e3===t.data.code?(e.$message({type:"success",message:t.data.data}),e.initForm(),window.bus.$emit("mask_statistical"),window.bus.$emit("temperature_query")):e.$message({type:"error",message:t.data.data}):e.$message({type:"error",message:"提交失败！"})}).catch(function(t){e.$message({type:"error",message:"服务器异常！"})})},loadOffices:function(){var e=this;de("/office/all",null).then(function(t){200==t.status?e.offices=t.data.data:e.$message({type:"error",message:"科室目录加载失败！"})},function(t){e.$message({type:"error",message:"科室目录加载失败！"})})}}},Z={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main"},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.form.temperatures,"max-height":"630",border:""}},[a("el-table-column",{staticStyle:{width:"25%"},attrs:{label:"科室"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.office))])]}}])}),e._v(" "),a("el-table-column",{staticStyle:{width:"25%"},attrs:{label:"姓名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),e.currentTime<e.forenoon?a("el-table-column",{staticStyle:{width:"25%"},attrs:{label:"上午温度"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form-item",{attrs:{prop:"temperatures."+t.$index+".temperatureAM",rules:e.rules.temperatureAM}},[a("el-input",{ref:t.row.id,model:{value:t.row.temperatureAM,callback:function(a){e.$set(t.row,"temperatureAM",a)},expression:"scope.row.temperatureAM"}})],1)]}}],null,!1,2116841739)}):e._e(),e._v(" "),e.currentTime>e.forenoon?a("el-table-column",{staticStyle:{width:"25%"},attrs:{label:"下午温度"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form-item",{attrs:{prop:"temperatures."+t.$index+".temperaturePM",rules:e.rules.temperaturePM}},[a("el-input",{ref:t.row.id,model:{value:t.row.temperaturePM,callback:function(a){e.$set(t.row,"temperaturePM",a)},expression:"scope.row.temperaturePM"}})],1)]}}],null,!1,874404186)}):e._e(),e._v(" "),a("el-table-column",{staticStyle:{width:"25%"},attrs:{label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form-item",[a("el-select",{model:{value:t.row.note,callback:function(a){e.$set(t.row,"note",a)},expression:"scope.row.note"}},e._l(e.options,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1)]}}])})],1),e._v(" "),a("el-form-item",[e.isShow?a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSumbit("form")}}},[e._v("保存")]):e._e(),e._v(" "),e.isShow?a("el-button",{on:{click:function(t){return e.resetForm("form")}}},[e._v("重置")]):e._e()],1)],1)],1)},staticRenderFns:[]},K={data:function(){return{form:{office:"",name:"",temperatureAM:"",temperaturePM:"",note:"",today:""},temperatures:[],offices:[],currentUser:"",role:"",currentPageNum:1,totalCount:-1,pageSize:10,isShowDiglog:!1,updateForm:{},options:[{label:"正常",value:"正常"},{label:"上午请假",value:"上午请假"},{label:"下午请假",value:"下午请假"},{label:"请假一天",value:"请假一天"},{label:"通宵调休",value:"通宵调休"}],currentOffice:""}},beforeDestroy:function(){window.bus.$off("temperature_query")},mounted:function(){var e=this;this.currentUser=JSON.parse(m("currentUser")),this.getRole(),this.loadOffices(),this.loadTemperatures(),window.bus.$on("temperature_query",function(){e.loadTemperatures()})},methods:{onSubmit:function(){this.loadTemperatures()},loadTemperatures:function(){var e={office:this.form.office,name:this.form.name,temperatureAM:this.form.temperatureAM,temperaturePM:this.form.temperaturePM,note:this.form.note,today:this.form.today,currentPageNum:this.currentPageNum,pageSize:this.pageSize};"体温管理员"!==this.role&&"超级管理员"!==this.role&&"公司领导"!==this.role&&"部门领导"!==this.role&&(e.office=this.currentUser.office),null==e.today&&(e.today="");var t=this;ue("/temperature/page",e).then(function(e){200==e.status?(t.temperatures=e.data.data.records,null!=t.offices&&(t.temperatures=c(e.data.data.records,t.offices)),t.totalCount=e.data.data.totalCount):t.$message({type:"error",message:"加载数据失败!"})}).catch(function(e){t.$message({type:"error",message:"服务器响应异常!"})})},loadOffices:function(){var e=this;de("/office/all").then(function(t){if(200==t.status){e.offices=t.data.data,null!=e.temperatures&&(e.temperatures=c(e.temperatures,e.offices));var a=[{office:e.currentUser.office}];e.currentOffice=c(a,e.offices)[0].office}else e.$message({type:"error",message:"科室目录加载失败！"})},function(t){e.$message({type:"error",message:"科室目录加载失败！"})})},getRole:function(){for(var e=0;e<this.currentUser.roles.length;e++)if("超级管理员"===this.currentUser.roles[e].name||"公司领导"===this.currentUser.roles[e].name||"部门领导"===this.currentUser.roles[e].name||"体温管理员"===this.currentUser.roles[e].name||"科室主任"===this.currentUser.roles[e].name){this.role=this.currentUser.roles[e].name;break}},handleCurrentChange:function(e){this.currentPageNum=e,this.loadTemperatures()},handleEidt:function(e,t){this.updateForm=t,this.isShowDiglog=!0},handleDelete:function(e,t){var a=this;this.$confirm("是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.delete(t.id)}).catch(function(){})},save:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return t.$message({type:"error",message:"请完整填写信息！！！"}),!1;var a=t,l=new Array;l.push(t.updateForm),me("/temperature/update",l).then(function(e){200==e.status?1e3===e.data.code?(a.isShowDiglog=!1,a.userForm="",a.$message({type:"success",message:e.data.data}),a.loadTemperatures()):a.$message({type:"error",message:e.data.data}):a.$message({type:"error",message:"提交失败"})},function(e){403==e.response.status?a.$message({type:"error",message:e.response.data}):a.$message({type:"error",message:"根本找不到服务器"})})})},delete:function(e){var t=this;de("/temperature/delete/"+e).then(function(e){200==e.status?1e3===e.data.code?(t.$message({type:"success",message:e.data.data}),t.loadTemperatures()):t.$message({type:"error",message:e.data.data}):t.$message({type:"error",message:"删除失败"})})}}},X={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main_div"},[a("div",{staticClass:"search_div",staticStyle:{display:"flex","justify-content":"flex-start"}},[a("el-form",{ref:"form",staticClass:"search_form",attrs:{inline:"",model:e.form,"label-width":"80px",size:"mini"}},[a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"姓名"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"科室"}},["体温管理员"===e.role||"超级管理员"===e.role||"公司领导"===e.role||"部门领导"===e.role?a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择科室"},model:{value:e.form.office,callback:function(t){e.$set(e.form,"office",t)},expression:"form.office"}},e._l(e.offices,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1):a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择科室"},model:{value:e.form.office,callback:function(t){e.$set(e.form,"office",t)},expression:"form.office"}},[a("el-option",{attrs:{label:e.currentOffice,value:e.currentUser.office}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"上午温度"}},[a("el-input",{model:{value:e.form.temperatureAM,callback:function(t){e.$set(e.form,"temperatureAM",t)},expression:"form.temperatureAM"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"下午温度"}},[a("el-input",{model:{value:e.form.temperaturePM,callback:function(t){e.$set(e.form,"temperaturePM",t)},expression:"form.temperaturePM"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",{attrs:{label:"日期"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.form.today,callback:function(t){e.$set(e.form,"today",t)},expression:"form.today"}})],1)],1),e._v(" "),a("el-col",{attrs:{md:12,lg:8}},[a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini",round:""},on:{click:e.onSubmit}},[e._v("查询")])],1)],1)],1)],1),e._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.temperatures,"max-height":"520","tooltip-effect":"dark"}},[a("el-table-column",{staticStyle:{width:"5%"},attrs:{label:"序号",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.$index+1))])]}}])}),e._v(" "),a("el-table-column",{staticStyle:{width:"10%"},attrs:{label:"科室",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.office))])]}}])}),e._v(" "),a("el-table-column",{staticStyle:{width:"10%"},attrs:{label:"姓名",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),a("el-table-column",{staticStyle:{width:"5%"},attrs:{label:"上午",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:t.row.temperatureAM>37.1?"temp_color":""},[e._v(e._s(t.row.temperatureAM))])]}}])}),e._v(" "),a("el-table-column",{staticStyle:{width:"5%"},attrs:{label:"下午",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:t.row.temperaturePM>37.1?"temp_color":""},[e._v(e._s(t.row.temperaturePM))])]}}])}),e._v(" "),a("el-table-column",{staticStyle:{width:"10%"},attrs:{label:"口罩发放",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.mask))])]}}])}),e._v(" "),a("el-table-column",{staticStyle:{width:"20%"},attrs:{label:"备注",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.note))])]}}])}),e._v(" "),a("el-table-column",{staticStyle:{width:"10%"},attrs:{label:"时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.today))])]}}])}),e._v(" "),"科室主任"===e.role||"体温记录员"===e.role||"体温管理员"===e.role||"超级管理员"===e.role?a("el-table-column",{attrs:{label:"操作",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary",round:""},on:{click:function(a){return e.handleEidt(t.$index,t.row)}}},[e._v("修改")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger",round:""},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}],null,!1,3942541297)}):e._e()],1),e._v(" "),a("el-dialog",{attrs:{title:"修改",visible:e.isShowDiglog,width:"30%",center:""},on:{"update:visible":function(t){e.isShowDiglog=t}}},[a("el-form",{ref:"updateForm",attrs:{model:e.updateForm}},[a("el-form-item",{attrs:{label:"科室:","label-width":"80px"}},[a("span",[e._v(e._s(e.updateForm.office))])]),e._v(" "),a("el-form-item",{attrs:{label:"姓名:","label-width":"80px"}},[a("span",[e._v(e._s(e.updateForm.name))])]),e._v(" "),a("el-form-item",{attrs:{label:"时间:","label-width":"80px"}},[a("span",[e._v(e._s(e.updateForm.today))])]),e._v(" "),a("el-form-item",{attrs:{label:"上午温度","label-width":"80px"}},[a("el-input",{model:{value:e.updateForm.temperatureAM,callback:function(t){e.$set(e.updateForm,"temperatureAM",t)},expression:"updateForm.temperatureAM"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"下午温度","label-width":"80px"}},[a("el-input",{model:{value:e.updateForm.temperaturePM,callback:function(t){e.$set(e.updateForm,"temperaturePM",t)},expression:"updateForm.temperaturePM"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注","label-width":"80px"}},[a("el-select",{model:{value:e.updateForm.note,callback:function(t){e.$set(e.updateForm,"note",t)},expression:"updateForm.note"}},e._l(e.options,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.isShowDiglog=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.save("updateForm")}}},[e._v("保存")])],1)],1),e._v(" "),a("div",{staticClass:"list_footer"},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.temperatures.length>0,expression:"temperatures.length>0"}],attrs:{"current-page":e.currentPageNum,"page-size":e.pageSize,layout:"total,prev, pager, next, jumper",total:e.totalCount},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPageNum=t},"update:current-page":function(t){e.currentPageNum=t}}})],1)],1)},staticRenderFns:[]};var ee={data:function(){return{maskList:[],currentUser:"",role:"",isShow:!1,offices:[]}},mounted:function(){var e=this;this.currentUser=JSON.parse(m("currentUser")),this.loadOffices(),this.getRole(),this.loadMasks(),window.bus.$on("mask_statistical",function(){e.loadMasks()})},methods:{loadMasks:function(){var e=this,t="/temperature/sum/";"超级管理员"!==this.role&&"公司领导"!==this.role&&"部门领导"!==this.role&&"体温管理员"!==this.role?t+=this.currentUser.office:(t+="all",e.isShow=!0),de(t).then(function(t){200==t.status&&e.offices.length>0&&(e.maskList=c(t.data.data,e.offices))})},getRole:function(){for(var e=0;e<this.currentUser.roles.length;e++)if("超级管理员"===this.currentUser.roles[e].name||"公司领导"===this.currentUser.roles[e].name||"部门领导"===this.currentUser.roles[e].name||"体温管理员"===this.currentUser.roles[e].name){this.role=this.currentUser.roles[e].name;break}},handleDownload:function(){var e=this;fe("/temperature/export","").then(function(t){if(200==t.status){if(0==t.data.size)return void e.$message({type:"error",message:"导出失败"});var a=window.URL.createObjectURL(new Blob([t.data])),l=document.createElement("a");l.style.display="none",l.href=a,l.setAttribute("download","体温记录.xlsx"),document.body.appendChild(l),l.click(),window.URL.revokeObjectURL(l.href),e.$message({type:"success",message:"正在下载！"})}else e.$message({type:"error",message:"导出失败"})})},loadOffices:function(){var e=this;de("/office/all",null).then(function(t){200==t.status?(e.offices=t.data.data,e.maskList.length>0&&(e.maskList=idToName_anounce(e.maskList,e.offices))):e.$message({type:"error",message:"科室目录加载失败！"})},function(t){e.$message({type:"error",message:"科室目录加载失败！"})})}}},te={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main_div"},[a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.maskList,"max-height":"630","tooltip-effect":"dark"}},[a("el-table-column",{staticStyle:{width:"5%"},attrs:{label:"序号",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.$index+1))])]}}])}),e._v(" "),a("el-table-column",{staticStyle:{width:"10%"},attrs:{label:"科室",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.office))])]}}])}),e._v(" "),a("el-table-column",{staticStyle:{width:"10%"},attrs:{label:"总人数",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.persons))])]}}])}),e._v(" "),a("el-table-column",{staticStyle:{width:"5%"},attrs:{label:"上午",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:"未提交"===t.row.submitAM?"temp_color":""},[e._v("\n\t\t        "+e._s(t.row.submitAM))])]}}])}),e._v(" "),a("el-table-column",{staticStyle:{width:"5%"},attrs:{label:"下午",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:"未提交"===t.row.submitPM?"temp_color":""},[e._v("\n\t\t        \t"+e._s(t.row.submitPM)+"\n\t\t    \t")])]}}])}),e._v(" "),a("el-table-column",{staticStyle:{width:"10%"},attrs:{label:"口罩发放",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.maskTotal))])]}}])}),e._v(" "),a("el-table-column",{staticStyle:{width:"10%"},attrs:{label:"时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.today))])]}}])})],1),e._v(" "),e.isShow?a("div",{staticStyle:{"margin-top":"20px"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleDownload}},[e._v("导出")])],1):e._e()],1)},staticRenderFns:[]};var ae={data:function(){return{activeName:"temperatureInput"}},mounted:function(){},methods:{handleClick:function(e,t){}},components:{temperature_input:a("VU/8")(Y,Z,!1,null,null,null).exports,temperature_query:a("VU/8")(K,X,!1,function(e){a("Lku9")},null,null).exports,mask_statistical:a("VU/8")(ee,te,!1,function(e){a("oB+S")},null,null).exports}},le={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{staticClass:"temperature"},[a("el-main",{staticClass:"main"},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"温度录入",name:"temperatureInput"}},[a("temperature_input",{key:"t1"})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"口罩统计",name:"maskStatistical"}},[a("mask_statistical",{key:"t2"})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"温度查看",name:"temperatureQuery"}},[a("temperature_query",{key:"t3"})],1)],1)],1)],1)},staticRenderFns:[]};var se=a("VU/8")(ae,le,!1,function(e){a("sUTS")},null,null).exports;l.default.use(o.a);var ie=new o.a({routes:[{path:"/",name:"登录",hidden:!0,component:b},{path:"/home",name:"部门发文",component:h,iconCls:"el-icon-folder",meta:{requireAuth:!0},children:[{path:"/fileList",name:"文档列表",component:j,meta:{keepAlive:!0,requireAuth:!0}},{path:"/fileUpload",name:"上传文档",component:V,meta:{keepAlive:!1,requireAuth:!0}}]},{path:"/home",name:"首页",component:h,meta:{requireAuth:!0},children:[{path:"/temperature",name:"体温记录",iconCls:"el-icon-s-data",component:se,meta:{requireAuth:!0}}]},{path:"/home",name:"首页",component:h,meta:{requireAuth:!0},children:[{path:"/user",name:"用户管理",iconCls:"el-icon-user",component:J,meta:{requireAuth:!0}}]}]});ie.beforeEach(function(e,t,a){e.meta.requireAuth?sessionStorage.getItem("isLogin")?a():a({path:"/"}):a()});var oe=o.a.prototype.push;o.a.prototype.push=function(e){return oe.call(this,e).catch(function(e){return e})};var re=ie,ne="/DeptFileSite",ue=function(e,t){return i()({method:"post",url:""+ne+e,data:t,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(e){var t="";for(var a in e)t+=encodeURIComponent(a)+"="+encodeURIComponent(e[a])+"&";return t}],withCredentials:!0})},ce=function(e,t){return i()({method:"post",url:""+ne+e,data:t,headers:{"Content-Type":"multipart/form-data"},withCredentials:!0})},fe=function(e,t){return i()({method:"post",url:""+ne+e,data:t,headers:{"Content-Type":"application/x-www-form-urlencoded"},responseType:"blob",transformRequest:[function(e){var t="";for(var a in e)t+=encodeURIComponent(a)+"="+encodeURIComponent(e[a])+"&";return t}],withCredentials:!0})},me=function(e,t){return i()({method:"put",url:""+ne+e,data:t,headers:{"Content-Type":"application/json;charset=utf-8"},withCredentials:!0})},de=function(e,t){return i()({method:"get",data:t,transformRequest:[function(e){var t="";for(var a in e)t+=encodeURIComponent(a)+"="+encodeURIComponent(e[a])+"&";return t}],headers:{"Content-Type":"application/x-www-form-urlencoded"},url:""+ne+e,withCredentials:!0})};i.a.interceptors.response.use(function(e){if(!e.status||200!=e.status||500!=e.data.status)return e.data.msg,e},function(e){return 504==e.status||404==e.status||(403==e.status?R.Message.error({message:"尚无权限!"}):401==e.status&&(R.Message.error({message:"尚未登录，请先登录!"}),re.replace("/"))),e});var pe={name:"App",data:function(){return{timmer:null}},methods:{overTimeOperation:function(){if("登录"!==this.$route.name){clearTimeout(this.timmer);var e=this;this.timmer=setTimeout(function(){sessionStorage.clear(),e.$alert("长时间未操作，请重新登录！","登录过时",{confirmButtonText:"确定",type:"warning",callback:function(t){de("/logout"),e.$router.push({path:"/"})}})},18e5)}}}},he={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"},on:{mouseover:this.overTimeOperation}},[t("router-view")],1)},staticRenderFns:[]};var ve=a("VU/8")(pe,he,!1,function(e){a("RyAq")},null,null).exports;a("tvR6"),a("briU");l.default.config.productionTip=!1,l.default.use(L.a),window.bus=new l.default,l.default.directive("has",{inserted:function(e,t){l.default.prototype.$_has(t.value)||e.parentNode.removeChild(e)}}),l.default.prototype.$_has=function(e){var t=!1,a=m("permissions");return void 0!==a&&null!=a&&(a.indexOf(e)>-1&&(t=!0),t)},new l.default({el:"#app",router:re,components:{App:ve},template:"<App/>"})},RyAq:function(e,t){},blJu:function(e,t){},ejqp:function(e,t){},fi3o:function(e,t){},i0DN:function(e,t){},"oB+S":function(e,t){},pCpa:function(e,t){},rzs2:function(e,t){},sUTS:function(e,t){},tvR6:function(e,t){},wFO6:function(e,t){},x9Iy:function(e,t){},yPGt:function(e,t){}},[0]);
//# sourceMappingURL=app.000df3498ab335364e80.js.map